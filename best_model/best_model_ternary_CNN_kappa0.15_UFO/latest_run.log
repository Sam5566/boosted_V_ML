

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
New Run
Current date and time = 2022-12-23 15:39:58.216588
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
The data set contains images
Number of training datasets: 480000.
Epoch 1/100
937/937 [==============================] - 320s 321ms/step - loss: 3.0568 - accuracy: 0.5776 - val_loss: 1.0016 - val_accuracy: 0.6235

Epoch 00001: val_loss improved from inf to 1.00159, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 2/100
937/937 [==============================] - 269s 287ms/step - loss: 0.9170 - accuracy: 0.6228 - val_loss: 0.8751 - val_accuracy: 0.6296

Epoch 00002: val_loss improved from 1.00159 to 0.87509, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 3/100
937/937 [==============================] - 292s 312ms/step - loss: 0.8742 - accuracy: 0.6286 - val_loss: 0.8625 - val_accuracy: 0.6332

Epoch 00003: val_loss improved from 0.87509 to 0.86246, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 4/100
937/937 [==============================] - 260s 277ms/step - loss: 0.8617 - accuracy: 0.6344 - val_loss: 0.8516 - val_accuracy: 0.6390

Epoch 00004: val_loss improved from 0.86246 to 0.85160, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 5/100
937/937 [==============================] - 265s 283ms/step - loss: 0.8515 - accuracy: 0.6409 - val_loss: 0.8406 - val_accuracy: 0.6475

Epoch 00005: val_loss improved from 0.85160 to 0.84063, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 6/100
937/937 [==============================] - 261s 278ms/step - loss: 0.8439 - accuracy: 0.6450 - val_loss: 0.8367 - val_accuracy: 0.6491

Epoch 00006: val_loss improved from 0.84063 to 0.83671, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 7/100
937/937 [==============================] - 263s 281ms/step - loss: 0.8381 - accuracy: 0.6485 - val_loss: 0.8279 - val_accuracy: 0.6543

Epoch 00007: val_loss improved from 0.83671 to 0.82790, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 8/100
937/937 [==============================] - 263s 281ms/step - loss: 0.8332 - accuracy: 0.6516 - val_loss: 0.8272 - val_accuracy: 0.6545

Epoch 00008: val_loss improved from 0.82790 to 0.82715, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 9/100
937/937 [==============================] - 240s 256ms/step - loss: 0.8295 - accuracy: 0.6532 - val_loss: 0.8240 - val_accuracy: 0.6562

Epoch 00009: val_loss improved from 0.82715 to 0.82404, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 10/100
937/937 [==============================] - 233s 249ms/step - loss: 0.8263 - accuracy: 0.6545 - val_loss: 0.8210 - val_accuracy: 0.6578

Epoch 00010: val_loss improved from 0.82404 to 0.82103, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 11/100
937/937 [==============================] - 232s 247ms/step - loss: 0.8234 - accuracy: 0.6565 - val_loss: 0.8192 - val_accuracy: 0.6583

Epoch 00011: val_loss improved from 0.82103 to 0.81920, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 12/100
937/937 [==============================] - 259s 276ms/step - loss: 0.8209 - accuracy: 0.6576 - val_loss: 0.8173 - val_accuracy: 0.6600

Epoch 00012: val_loss improved from 0.81920 to 0.81734, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 13/100
937/937 [==============================] - 256s 273ms/step - loss: 0.8191 - accuracy: 0.6583 - val_loss: 0.8149 - val_accuracy: 0.6604

Epoch 00013: val_loss improved from 0.81734 to 0.81488, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 14/100
937/937 [==============================] - 159s 170ms/step - loss: 0.8175 - accuracy: 0.6595 - val_loss: 0.8134 - val_accuracy: 0.6614

Epoch 00014: val_loss improved from 0.81488 to 0.81343, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 15/100
937/937 [==============================] - 67s 71ms/step - loss: 0.8151 - accuracy: 0.6610 - val_loss: 0.8100 - val_accuracy: 0.6632

Epoch 00015: val_loss improved from 0.81343 to 0.81004, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 16/100
937/937 [==============================] - 65s 70ms/step - loss: 0.8130 - accuracy: 0.6625 - val_loss: 0.8095 - val_accuracy: 0.6640

Epoch 00016: val_loss improved from 0.81004 to 0.80950, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 17/100
937/937 [==============================] - 66s 71ms/step - loss: 0.8117 - accuracy: 0.6631 - val_loss: 0.8077 - val_accuracy: 0.6646

Epoch 00017: val_loss improved from 0.80950 to 0.80767, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 18/100
937/937 [==============================] - 65s 70ms/step - loss: 0.8100 - accuracy: 0.6643 - val_loss: 0.8075 - val_accuracy: 0.6648

Epoch 00018: val_loss improved from 0.80767 to 0.80750, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 19/100
937/937 [==============================] - 65s 70ms/step - loss: 0.8083 - accuracy: 0.6651 - val_loss: 0.8057 - val_accuracy: 0.6660

Epoch 00019: val_loss improved from 0.80750 to 0.80570, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 20/100
937/937 [==============================] - 64s 69ms/step - loss: 0.8074 - accuracy: 0.6651 - val_loss: 0.8038 - val_accuracy: 0.6664

Epoch 00020: val_loss improved from 0.80570 to 0.80375, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 21/100
937/937 [==============================] - 64s 69ms/step - loss: 0.8058 - accuracy: 0.6667 - val_loss: 0.8050 - val_accuracy: 0.6661

Epoch 00021: val_loss did not improve from 0.80375
Epoch 22/100
937/937 [==============================] - 64s 69ms/step - loss: 0.8050 - accuracy: 0.6676 - val_loss: 0.8056 - val_accuracy: 0.6646

Epoch 00022: val_loss did not improve from 0.80375
Epoch 23/100
937/937 [==============================] - 64s 69ms/step - loss: 0.8034 - accuracy: 0.6681 - val_loss: 0.8022 - val_accuracy: 0.6673

Epoch 00023: val_loss improved from 0.80375 to 0.80222, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 24/100
937/937 [==============================] - 64s 69ms/step - loss: 0.8021 - accuracy: 0.6694 - val_loss: 0.8028 - val_accuracy: 0.6666

Epoch 00024: val_loss did not improve from 0.80222
Epoch 25/100
937/937 [==============================] - 64s 68ms/step - loss: 0.8004 - accuracy: 0.6703 - val_loss: 0.8031 - val_accuracy: 0.6662

Epoch 00025: val_loss did not improve from 0.80222
Epoch 26/100
937/937 [==============================] - 64s 68ms/step - loss: 0.7992 - accuracy: 0.6711 - val_loss: 0.8018 - val_accuracy: 0.6677

Epoch 00026: val_loss improved from 0.80222 to 0.80177, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15_UFO/Try/0
Epoch 27/100
937/937 [==============================] - 64s 68ms/step - loss: 0.7981 - accuracy: 0.6718 - val_loss: 0.8029 - val_accuracy: 0.6664

Epoch 00027: val_loss did not improve from 0.80177
Epoch 28/100
937/937 [==============================] - 64s 68ms/step - loss: 0.7971 - accuracy: 0.6723 - val_loss: 0.8029 - val_accuracy: 0.6664

Epoch 00028: val_loss did not improve from 0.80177
Epoch 29/100
937/937 [==============================] - 64s 69ms/step - loss: 0.7961 - accuracy: 0.6735 - val_loss: 0.8022 - val_accuracy: 0.6670

Epoch 00029: val_loss did not improve from 0.80177
Epoch 30/100
937/937 [==============================] - 64s 68ms/step - loss: 0.7948 - accuracy: 0.6741 - val_loss: 0.8027 - val_accuracy: 0.6667

Epoch 00030: val_loss did not improve from 0.80177
Epoch 31/100
937/937 [==============================] - 64s 69ms/step - loss: 0.7930 - accuracy: 0.6756 - val_loss: 0.8023 - val_accuracy: 0.6669

Epoch 00031: val_loss did not improve from 0.80177
Epoch 32/100
937/937 [==============================] - 64s 68ms/step - loss: 0.7916 - accuracy: 0.6765 - val_loss: 0.8022 - val_accuracy: 0.6664

Epoch 00032: val_loss did not improve from 0.80177
Epoch 33/100
937/937 [==============================] - 64s 68ms/step - loss: 0.7903 - accuracy: 0.6777 - val_loss: 0.8047 - val_accuracy: 0.6666

Epoch 00033: val_loss did not improve from 0.80177
Epoch 34/100
937/937 [==============================] - 64s 68ms/step - loss: 0.7889 - accuracy: 0.6787 - val_loss: 0.8046 - val_accuracy: 0.6658

Epoch 00034: val_loss did not improve from 0.80177
Epoch 35/100
937/937 [==============================] - 64s 68ms/step - loss: 0.7879 - accuracy: 0.6795 - val_loss: 0.8092 - val_accuracy: 0.6639

Epoch 00035: val_loss did not improve from 0.80177
Epoch 36/100
937/937 [==============================] - 64s 69ms/step - loss: 0.7873 - accuracy: 0.6803 - val_loss: 0.8067 - val_accuracy: 0.6657

Epoch 00036: val_loss did not improve from 0.80177
Epoch 00036: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential (Sequential)      (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_2 (Dense)              multiple                  1539      [0m
[92m=================================================================[0m
[92mTotal params: 12,129,451[0m
[92mTrainable params: 12,129,447[0m
[92mNon-trainable params: 4[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda (Lambda)              (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization (BatchNo (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d (Conv2D)              (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d (MaxPooling2D) (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_1 (Conv2D)            (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_1 (MaxPooling2 (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_2 (Conv2D)            (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_2 (MaxPooling2 (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout (Dropout)            (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten (Flatten)            (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense (Dense)                (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_1 (Dropout)          (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_1 (Dense)              (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_2 (Dropout)          (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 2), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAGQAhQJm\nBBkAUwCpAU6pAKkB2gF4cgIAAAByAgAAAPofL2hvbWUvc2FtaHVhbmcvTUwvQ05OL21vZGVscy5w\nedoIPGxhbWJkYT4PAAAA8wAAAAA=\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_1', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_1', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_2', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_2', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_1', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_1', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_2', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_2', 'trainable': True, 'dtype': 'float32', 'units': 3, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
150000/150000 [==============================] - 568s 4ms/step - loss: 0.7992 - accuracy: 0.6679
Testing Loss = 0.799185, Testing Accuracy = 0.667893
The data set contains images
N of classes 3
$W^+$ (auc = 84.85 +- 0.0000 %)
$W^-$ (auc = 84.72 +- 0.0000 %)
$Z$ (auc = 80.90 +- 0.0000 %)
N of classes 3
$W^+$ (acc = 65.80 +- 0.0000 %
$W^-$ (acc = 68.10 +- 0.0000 %
$Z$ (acc = 66.56 +- 0.0000 %
The summarized testing accuracy = 66.79 +- 0.0000 %, with the loss = 0.7992 +- 0.000000
