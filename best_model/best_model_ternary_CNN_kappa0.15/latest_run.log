

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
New Run
Current date and time = 2023-01-03 17:01:15.254466
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
The data set contains images
Number of training datasets: 383186.
Epoch 1/100
748/748 [==============================] - 660s 823ms/step - loss: 4.3917 - accuracy: 0.3475 - val_loss: 2.0221 - val_accuracy: 0.3637

Epoch 00001: val_loss improved from inf to 2.02210, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15/Try/0
Epoch 2/100
748/748 [==============================] - 620s 828ms/step - loss: 1.6276 - accuracy: 0.3819 - val_loss: 1.3468 - val_accuracy: 0.4854

Epoch 00002: val_loss improved from 2.02210 to 1.34675, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15/Try/0
Epoch 3/100
748/748 [==============================] - 608s 812ms/step - loss: 1.2214 - accuracy: 0.4749 - val_loss: 1.1330 - val_accuracy: 0.4685

Epoch 00003: val_loss improved from 1.34675 to 1.13296, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15/Try/0
Epoch 4/100
748/748 [==============================] - 604s 807ms/step - loss: 1.0649 - accuracy: 0.4975 - val_loss: 1.0225 - val_accuracy: 0.5153

Epoch 00004: val_loss improved from 1.13296 to 1.02253, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15/Try/0
Epoch 5/100
748/748 [==============================] - 603s 806ms/step - loss: 1.0033 - accuracy: 0.5049 - val_loss: 0.9972 - val_accuracy: 0.4949

Epoch 00005: val_loss improved from 1.02253 to 0.99718, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15/Try/0
Epoch 6/100
748/748 [==============================] - 604s 808ms/step - loss: 0.9810 - accuracy: 0.5078 - val_loss: 1.0227 - val_accuracy: 0.4398

Epoch 00006: val_loss did not improve from 0.99718
Epoch 7/100
748/748 [==============================] - 601s 804ms/step - loss: 0.9715 - accuracy: 0.5094 - val_loss: 0.9927 - val_accuracy: 0.4777

Epoch 00007: val_loss improved from 0.99718 to 0.99266, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15/Try/0
Epoch 8/100
748/748 [==============================] - 601s 803ms/step - loss: 0.9676 - accuracy: 0.5092 - val_loss: 0.9727 - val_accuracy: 0.4965

Epoch 00008: val_loss improved from 0.99266 to 0.97268, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15/Try/0
Epoch 9/100
748/748 [==============================] - 600s 802ms/step - loss: 0.9646 - accuracy: 0.5108 - val_loss: 0.9608 - val_accuracy: 0.5065

Epoch 00009: val_loss improved from 0.97268 to 0.96080, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15/Try/0
Epoch 10/100
748/748 [==============================] - 600s 802ms/step - loss: 0.9637 - accuracy: 0.5124 - val_loss: 1.0050 - val_accuracy: 0.4558

Epoch 00010: val_loss did not improve from 0.96080
Epoch 11/100
748/748 [==============================] - 599s 801ms/step - loss: 0.9620 - accuracy: 0.5130 - val_loss: 0.9960 - val_accuracy: 0.4674

Epoch 00011: val_loss did not improve from 0.96080
Epoch 12/100
748/748 [==============================] - 599s 800ms/step - loss: 0.9602 - accuracy: 0.5132 - val_loss: 0.9876 - val_accuracy: 0.4752

Epoch 00012: val_loss did not improve from 0.96080
Epoch 13/100
748/748 [==============================] - 598s 800ms/step - loss: 0.9602 - accuracy: 0.5134 - val_loss: 0.9826 - val_accuracy: 0.4806

Epoch 00013: val_loss did not improve from 0.96080
Epoch 14/100
748/748 [==============================] - 598s 799ms/step - loss: 0.9590 - accuracy: 0.5143 - val_loss: 0.9521 - val_accuracy: 0.5255

Epoch 00014: val_loss improved from 0.96080 to 0.95209, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15/Try/0
Epoch 15/100
748/748 [==============================] - 597s 798ms/step - loss: 0.9572 - accuracy: 0.5150 - val_loss: 1.1186 - val_accuracy: 0.3703

Epoch 00015: val_loss did not improve from 0.95209
Epoch 16/100
748/748 [==============================] - 597s 798ms/step - loss: 0.9573 - accuracy: 0.5148 - val_loss: 0.9780 - val_accuracy: 0.4806

Epoch 00016: val_loss did not improve from 0.95209
Epoch 17/100
748/748 [==============================] - 597s 798ms/step - loss: 0.9556 - accuracy: 0.5159 - val_loss: 0.9590 - val_accuracy: 0.5051

Epoch 00017: val_loss did not improve from 0.95209
Epoch 18/100
748/748 [==============================] - 597s 798ms/step - loss: 0.9550 - accuracy: 0.5167 - val_loss: 0.9797 - val_accuracy: 0.4816

Epoch 00018: val_loss did not improve from 0.95209
Epoch 19/100
748/748 [==============================] - 596s 797ms/step - loss: 0.9540 - accuracy: 0.5173 - val_loss: 0.9943 - val_accuracy: 0.4627

Epoch 00019: val_loss did not improve from 0.95209
Epoch 20/100
748/748 [==============================] - 596s 797ms/step - loss: 0.9537 - accuracy: 0.5169 - val_loss: 0.9613 - val_accuracy: 0.5051

Epoch 00020: val_loss did not improve from 0.95209
Epoch 21/100
748/748 [==============================] - 596s 797ms/step - loss: 0.9524 - accuracy: 0.5177 - val_loss: 0.9952 - val_accuracy: 0.4580

Epoch 00021: val_loss did not improve from 0.95209
Epoch 22/100
748/748 [==============================] - 596s 797ms/step - loss: 0.9527 - accuracy: 0.5179 - val_loss: 1.0037 - val_accuracy: 0.4497

Epoch 00022: val_loss did not improve from 0.95209
Epoch 23/100
748/748 [==============================] - 596s 796ms/step - loss: 0.9523 - accuracy: 0.5187 - val_loss: 1.1165 - val_accuracy: 0.3698

Epoch 00023: val_loss did not improve from 0.95209
Epoch 24/100
748/748 [==============================] - 596s 796ms/step - loss: 0.9515 - accuracy: 0.5186 - val_loss: 0.9734 - val_accuracy: 0.4875

Epoch 00024: val_loss did not improve from 0.95209
Epoch 00024: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN3"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential (Sequential)      (None, 512)               365106984 [0m
[92m_________________________________________________________________[0m
[92mdense_2 (Dense)              multiple                  1539      [0m
[92m=================================================================[0m
[92mTotal params: 365,108,523[0m
[92mTrainable params: 365,107,687[0m
[92mNon-trainable params: 836[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda (Lambda)              (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization (BatchNo (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d (Conv2D)              (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_1 (Batch (None, 75, 75, 32)        128       [0m
[94m_________________________________________________________________[0m
[94mconv2d_1 (Conv2D)            (None, 75, 75, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d (MaxPooling2D) (None, 37, 37, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_2 (Batch (None, 37, 37, 128)       512       [0m
[94m_________________________________________________________________[0m
[94mconv2d_2 (Conv2D)            (None, 37, 37, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_3 (Batch (None, 37, 37, 256)       1024      [0m
[94m_________________________________________________________________[0m
[94mconv2d_3 (Conv2D)            (None, 37, 37, 512)       4719104   [0m
[94m_________________________________________________________________[0m
[94mflatten (Flatten)            (None, 700928)            0         [0m
[94m_________________________________________________________________[0m
[94mdense (Dense)                (None, 512)               358875648 [0m
[94m_________________________________________________________________[0m
[94mdropout (Dropout)            (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_1 (Dense)              (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_1 (Dropout)          (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 365,106,984[0m
[94mTrainable params: 365,106,148[0m
[94mNon-trainable params: 836[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 2), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAGQAhQJm\nBBkAUwCpAU6pAKkB2gF4cgIAAAByAgAAAPofL2hvbWUvc2FtaHVhbmcvTUwvQ05OL21vZGVscy5w\nedoIPGxhbWJkYT52AAAA8wAAAAA=\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_1', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_1', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_2', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_2', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_3', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_3', 'trainable': True, 'dtype': 'float32', 'filters': 512, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_1', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_1', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_2', 'trainable': True, 'dtype': 'float32', 'units': 3, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
119746/119746 [==============================] - 1279s 11ms/step - loss: 0.9519 - accuracy: 0.5252
Testing Loss = 0.951859, Testing Accuracy = 0.525237
The data set contains images
N of classes 3
$W^+$ (auc = 64.59 +- 0.0000 %)
$W^-$ (auc = 68.58 +- 0.0000 %)
$Z$ (auc = 82.19 +- 0.0000 %)
N of classes 3
$W^+$ (acc = 0.00 +- 0.0000 %
$W^-$ (acc = 46.01 +- 0.0000 %
$Z$ (acc = 60.10 +- 0.0000 %
The summarized testing accuracy = 52.52 +- 0.0000 %, with the loss = 0.9519 +- 0.000000
