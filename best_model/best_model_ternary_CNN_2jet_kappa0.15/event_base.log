

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
New Run
Current date and time = 2022-11-07 11:58:41.679373
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
The data set contains images
Number of training datasets: 48196.
Epoch 1/100
94/94 [==============================] - 23s 191ms/step - loss: 20.9741 - accuracy: 0.2385 - val_loss: 13.1770 - val_accuracy: 0.2671

Epoch 00001: val_loss improved from inf to 13.17700, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 2/100
94/94 [==============================] - 13s 138ms/step - loss: 9.9388 - accuracy: 0.2749 - val_loss: 7.6412 - val_accuracy: 0.2829

Epoch 00002: val_loss improved from 13.17700 to 7.64117, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 3/100
94/94 [==============================] - 13s 137ms/step - loss: 6.4193 - accuracy: 0.3020 - val_loss: 5.4122 - val_accuracy: 0.3255

Epoch 00003: val_loss improved from 7.64117 to 5.41222, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 4/100
94/94 [==============================] - 13s 137ms/step - loss: 4.6669 - accuracy: 0.3637 - val_loss: 4.1013 - val_accuracy: 0.3663

Epoch 00004: val_loss improved from 5.41222 to 4.10130, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 5/100
94/94 [==============================] - 13s 138ms/step - loss: 3.6094 - accuracy: 0.3793 - val_loss: 3.2323 - val_accuracy: 0.3833

Epoch 00005: val_loss improved from 4.10130 to 3.23231, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 6/100
94/94 [==============================] - 13s 138ms/step - loss: 2.9107 - accuracy: 0.3893 - val_loss: 2.6496 - val_accuracy: 0.3905

Epoch 00006: val_loss improved from 3.23231 to 2.64960, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 7/100
94/94 [==============================] - 13s 138ms/step - loss: 2.4412 - accuracy: 0.3891 - val_loss: 2.2710 - val_accuracy: 0.3921

Epoch 00007: val_loss improved from 2.64960 to 2.27105, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 8/100
94/94 [==============================] - 13s 138ms/step - loss: 2.1253 - accuracy: 0.3904 - val_loss: 2.0024 - val_accuracy: 0.3962

Epoch 00008: val_loss improved from 2.27105 to 2.00241, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 9/100
94/94 [==============================] - 13s 139ms/step - loss: 1.9137 - accuracy: 0.3958 - val_loss: 1.8341 - val_accuracy: 0.3950

Epoch 00009: val_loss improved from 2.00241 to 1.83406, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 10/100
94/94 [==============================] - 13s 138ms/step - loss: 1.7773 - accuracy: 0.3972 - val_loss: 1.7213 - val_accuracy: 0.4006

Epoch 00010: val_loss improved from 1.83406 to 1.72129, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 11/100
94/94 [==============================] - 13s 138ms/step - loss: 1.6864 - accuracy: 0.4010 - val_loss: 1.6501 - val_accuracy: 0.4033

Epoch 00011: val_loss improved from 1.72129 to 1.65006, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 12/100
94/94 [==============================] - 13s 139ms/step - loss: 1.6259 - accuracy: 0.4021 - val_loss: 1.6027 - val_accuracy: 0.4055

Epoch 00012: val_loss improved from 1.65006 to 1.60267, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 13/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5841 - accuracy: 0.4056 - val_loss: 1.5728 - val_accuracy: 0.4057

Epoch 00013: val_loss improved from 1.60267 to 1.57284, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 14/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5543 - accuracy: 0.4131 - val_loss: 1.5532 - val_accuracy: 0.4088

Epoch 00014: val_loss improved from 1.57284 to 1.55317, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 15/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5352 - accuracy: 0.4145 - val_loss: 1.5340 - val_accuracy: 0.4141

Epoch 00015: val_loss improved from 1.55317 to 1.53402, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 16/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5192 - accuracy: 0.4197 - val_loss: 1.5242 - val_accuracy: 0.4147

Epoch 00016: val_loss improved from 1.53402 to 1.52420, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 17/100
94/94 [==============================] - 13s 139ms/step - loss: 1.5060 - accuracy: 0.4199 - val_loss: 1.5145 - val_accuracy: 0.4173

Epoch 00017: val_loss improved from 1.52420 to 1.51450, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 18/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4974 - accuracy: 0.4246 - val_loss: 1.5074 - val_accuracy: 0.4198

Epoch 00018: val_loss improved from 1.51450 to 1.50738, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 19/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4904 - accuracy: 0.4270 - val_loss: 1.5045 - val_accuracy: 0.4193

Epoch 00019: val_loss improved from 1.50738 to 1.50453, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 20/100
94/94 [==============================] - 13s 140ms/step - loss: 1.4845 - accuracy: 0.4286 - val_loss: 1.5020 - val_accuracy: 0.4207

Epoch 00020: val_loss improved from 1.50453 to 1.50203, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 21/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4774 - accuracy: 0.4311 - val_loss: 1.4951 - val_accuracy: 0.4194

Epoch 00021: val_loss improved from 1.50203 to 1.49511, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 22/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4710 - accuracy: 0.4329 - val_loss: 1.4900 - val_accuracy: 0.4215

Epoch 00022: val_loss improved from 1.49511 to 1.48996, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 23/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4653 - accuracy: 0.4354 - val_loss: 1.4886 - val_accuracy: 0.4232

Epoch 00023: val_loss improved from 1.48996 to 1.48858, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 24/100
94/94 [==============================] - 13s 142ms/step - loss: 1.4634 - accuracy: 0.4380 - val_loss: 1.4881 - val_accuracy: 0.4232

Epoch 00024: val_loss improved from 1.48858 to 1.48813, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 25/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4585 - accuracy: 0.4406 - val_loss: 1.4949 - val_accuracy: 0.4212

Epoch 00025: val_loss did not improve from 1.48813
Epoch 26/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4563 - accuracy: 0.4415 - val_loss: 1.4867 - val_accuracy: 0.4243

Epoch 00026: val_loss improved from 1.48813 to 1.48665, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 27/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4508 - accuracy: 0.4432 - val_loss: 1.4880 - val_accuracy: 0.4243

Epoch 00027: val_loss did not improve from 1.48665
Epoch 28/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4484 - accuracy: 0.4470 - val_loss: 1.4897 - val_accuracy: 0.4223

Epoch 00028: val_loss did not improve from 1.48665
Epoch 29/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4447 - accuracy: 0.4472 - val_loss: 1.4866 - val_accuracy: 0.4237

Epoch 00029: val_loss improved from 1.48665 to 1.48659, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 30/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4376 - accuracy: 0.4523 - val_loss: 1.4936 - val_accuracy: 0.4195

Epoch 00030: val_loss did not improve from 1.48659
Epoch 31/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4337 - accuracy: 0.4532 - val_loss: 1.4960 - val_accuracy: 0.4207

Epoch 00031: val_loss did not improve from 1.48659
Epoch 32/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4302 - accuracy: 0.4573 - val_loss: 1.4976 - val_accuracy: 0.4200

Epoch 00032: val_loss did not improve from 1.48659
Epoch 33/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4238 - accuracy: 0.4595 - val_loss: 1.4911 - val_accuracy: 0.4276

Epoch 00033: val_loss did not improve from 1.48659
Epoch 34/100
94/94 [==============================] - 13s 140ms/step - loss: 1.4205 - accuracy: 0.4645 - val_loss: 1.4908 - val_accuracy: 0.4252

Epoch 00034: val_loss did not improve from 1.48659
Epoch 35/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4135 - accuracy: 0.4681 - val_loss: 1.4992 - val_accuracy: 0.4239

Epoch 00035: val_loss did not improve from 1.48659
Epoch 36/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4078 - accuracy: 0.4731 - val_loss: 1.5044 - val_accuracy: 0.4229

Epoch 00036: val_loss did not improve from 1.48659
Epoch 00036: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN_2jet"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential (Sequential)      (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92msequential_1 (Sequential)    (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_4 (Dense)              multiple                  6150      [0m
[92m=================================================================[0m
[92mTotal params: 24,261,974[0m
[92mTrainable params: 24,261,966[0m
[92mNon-trainable params: 8[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda (Lambda)              (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization (BatchNo (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d (Conv2D)              (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d (MaxPooling2D) (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_1 (Conv2D)            (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_1 (MaxPooling2 (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_2 (Conv2D)            (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_2 (MaxPooling2 (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout (Dropout)            (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten (Flatten)            (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense (Dense)                (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_1 (Dropout)          (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_1 (Dense)              (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_2 (Dropout)          (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQChQJm\nBBkAUwApA07pAAAAAOkCAAAAqQCpAdoBeHIDAAAAcgMAAAD6Hy9ob21lL3NhbWh1YW5nL01ML0NO\nTi9tb2RlbHMucHnaCDxsYW1iZGE+KAEAAPMAAAAA\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_1', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_1', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_2', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_2', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_1', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_1', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_2', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_1"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_1 (Lambda)            (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_1 (Batch (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_3 (Conv2D)            (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_3 (MaxPooling2 (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_4 (Conv2D)            (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_4 (MaxPooling2 (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_5 (Conv2D)            (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_5 (MaxPooling2 (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_3 (Dropout)          (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_1 (Flatten)          (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_2 (Dense)              (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_4 (Dropout)          (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_3 (Dense)              (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_5 (Dropout)          (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_1', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_1_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_1', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQAhQJm\nBBkAUwCpAk7pAgAAAKkAqQHaAXhyAwAAAHIDAAAA+h8vaG9tZS9zYW1odWFuZy9NTC9DTk4vbW9k\nZWxzLnB52gg8bGFtYmRhPjoBAADzAAAAAA==\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_1', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_3', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_3', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_4', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_4', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_5', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_5', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_3', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_1', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_2', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_4', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_3', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_5', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER3       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_4', 'trainable': True, 'dtype': 'float32', 'units': 6, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
15062/15062 [==============================] - 95s 6ms/step - loss: 1.4873 - accuracy: 0.4266
Testing Loss = 1.487277, Testing Accuracy = 0.426637
The data set contains images
N of classes 6
$W^+/W^+$ (auc = 80.87 +- 0.0000 %)
$W^-/W^-$ (auc = 80.33 +- 0.0000 %)
$Z/Z$ (auc = 79.77 +- 0.0000 %)
$W^+/W^-$ (auc = 69.36 +- 0.0000 %)
$W^+/Z$$ (auc = 78.81 +- 0.0000 %)
$W^-/Z$ (auc = 79.71 +- 0.0000 %)
The summarized testing accuracy = 42.66 +- 0.0000 %, with the loss = 1.4873 +- 0.000000


$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
New Run
Current date and time = 2022-11-07 12:14:14.975020
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
The data set contains images
Number of training datasets: 48196.
Epoch 1/100
94/94 [==============================] - 18s 140ms/step - loss: 20.9314 - accuracy: 0.2404 - val_loss: 13.1563 - val_accuracy: 0.2689

Epoch 00001: val_loss improved from inf to 13.15635, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 2/100
94/94 [==============================] - 13s 134ms/step - loss: 9.9345 - accuracy: 0.2744 - val_loss: 7.6431 - val_accuracy: 0.2806

Epoch 00002: val_loss improved from 13.15635 to 7.64312, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 3/100
94/94 [==============================] - 13s 135ms/step - loss: 6.4383 - accuracy: 0.2843 - val_loss: 5.4426 - val_accuracy: 0.2885

Epoch 00003: val_loss improved from 7.64312 to 5.44259, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 4/100
94/94 [==============================] - 13s 135ms/step - loss: 4.7193 - accuracy: 0.3266 - val_loss: 4.1122 - val_accuracy: 0.3374

Epoch 00004: val_loss improved from 5.44259 to 4.11224, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 5/100
94/94 [==============================] - 13s 135ms/step - loss: 3.6103 - accuracy: 0.3722 - val_loss: 3.2375 - val_accuracy: 0.3683

Epoch 00005: val_loss improved from 4.11224 to 3.23754, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 6/100
94/94 [==============================] - 13s 137ms/step - loss: 2.9041 - accuracy: 0.3848 - val_loss: 2.6426 - val_accuracy: 0.3874

Epoch 00006: val_loss improved from 3.23754 to 2.64261, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 7/100
94/94 [==============================] - 13s 136ms/step - loss: 2.4319 - accuracy: 0.3917 - val_loss: 2.2478 - val_accuracy: 0.3960

Epoch 00007: val_loss improved from 2.64261 to 2.24784, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 8/100
94/94 [==============================] - 13s 135ms/step - loss: 2.1207 - accuracy: 0.3923 - val_loss: 2.0023 - val_accuracy: 0.3969

Epoch 00008: val_loss improved from 2.24784 to 2.00225, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 9/100
94/94 [==============================] - 13s 134ms/step - loss: 1.9123 - accuracy: 0.3951 - val_loss: 1.8314 - val_accuracy: 0.3973

Epoch 00009: val_loss improved from 2.00225 to 1.83138, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 10/100
94/94 [==============================] - 13s 135ms/step - loss: 1.7724 - accuracy: 0.3979 - val_loss: 1.7195 - val_accuracy: 0.4034

Epoch 00010: val_loss improved from 1.83138 to 1.71947, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 11/100
94/94 [==============================] - 13s 135ms/step - loss: 1.6793 - accuracy: 0.4029 - val_loss: 1.6395 - val_accuracy: 0.4104

Epoch 00011: val_loss improved from 1.71947 to 1.63953, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 12/100
94/94 [==============================] - 13s 134ms/step - loss: 1.5928 - accuracy: 0.4255 - val_loss: 1.5351 - val_accuracy: 0.4484

Epoch 00012: val_loss improved from 1.63953 to 1.53510, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 13/100
94/94 [==============================] - 13s 133ms/step - loss: 1.5310 - accuracy: 0.4454 - val_loss: 1.5001 - val_accuracy: 0.4548

Epoch 00013: val_loss improved from 1.53510 to 1.50013, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 14/100
94/94 [==============================] - 13s 134ms/step - loss: 1.4973 - accuracy: 0.4506 - val_loss: 1.4754 - val_accuracy: 0.4570

Epoch 00014: val_loss improved from 1.50013 to 1.47541, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 15/100
94/94 [==============================] - 13s 134ms/step - loss: 1.4725 - accuracy: 0.4597 - val_loss: 1.4639 - val_accuracy: 0.4575

Epoch 00015: val_loss improved from 1.47541 to 1.46387, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 16/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4541 - accuracy: 0.4637 - val_loss: 1.4501 - val_accuracy: 0.4624

Epoch 00016: val_loss improved from 1.46387 to 1.45011, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 17/100
94/94 [==============================] - 13s 134ms/step - loss: 1.4436 - accuracy: 0.4658 - val_loss: 1.4470 - val_accuracy: 0.4620

Epoch 00017: val_loss improved from 1.45011 to 1.44700, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 18/100
94/94 [==============================] - 13s 134ms/step - loss: 1.4391 - accuracy: 0.4675 - val_loss: 1.4381 - val_accuracy: 0.4673

Epoch 00018: val_loss improved from 1.44700 to 1.43807, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 19/100
94/94 [==============================] - 13s 134ms/step - loss: 1.4249 - accuracy: 0.4712 - val_loss: 1.4381 - val_accuracy: 0.4639

Epoch 00019: val_loss improved from 1.43807 to 1.43806, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 20/100
94/94 [==============================] - 13s 135ms/step - loss: 1.4203 - accuracy: 0.4746 - val_loss: 1.4274 - val_accuracy: 0.4693

Epoch 00020: val_loss improved from 1.43806 to 1.42735, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 21/100
94/94 [==============================] - 13s 134ms/step - loss: 1.4124 - accuracy: 0.4787 - val_loss: 1.4293 - val_accuracy: 0.4702

Epoch 00021: val_loss did not improve from 1.42735
Epoch 22/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4035 - accuracy: 0.4815 - val_loss: 1.4234 - val_accuracy: 0.4721

Epoch 00022: val_loss improved from 1.42735 to 1.42339, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 23/100
94/94 [==============================] - 13s 135ms/step - loss: 1.4019 - accuracy: 0.4821 - val_loss: 1.4280 - val_accuracy: 0.4698

Epoch 00023: val_loss did not improve from 1.42339
Epoch 24/100
94/94 [==============================] - 13s 133ms/step - loss: 1.3954 - accuracy: 0.4862 - val_loss: 1.4314 - val_accuracy: 0.4690

Epoch 00024: val_loss did not improve from 1.42339
Epoch 25/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3917 - accuracy: 0.4890 - val_loss: 1.4309 - val_accuracy: 0.4689

Epoch 00025: val_loss did not improve from 1.42339
Epoch 26/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3885 - accuracy: 0.4900 - val_loss: 1.4253 - val_accuracy: 0.4716

Epoch 00026: val_loss did not improve from 1.42339
Epoch 27/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3819 - accuracy: 0.4937 - val_loss: 1.4293 - val_accuracy: 0.4717

Epoch 00027: val_loss did not improve from 1.42339
Epoch 28/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3803 - accuracy: 0.4961 - val_loss: 1.4218 - val_accuracy: 0.4747

Epoch 00028: val_loss improved from 1.42339 to 1.42181, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/0
Epoch 29/100
94/94 [==============================] - 13s 133ms/step - loss: 1.3734 - accuracy: 0.4993 - val_loss: 1.4280 - val_accuracy: 0.4710

Epoch 00029: val_loss did not improve from 1.42181
Epoch 30/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3678 - accuracy: 0.5012 - val_loss: 1.4236 - val_accuracy: 0.4763

Epoch 00030: val_loss did not improve from 1.42181
Epoch 31/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3634 - accuracy: 0.5024 - val_loss: 1.4256 - val_accuracy: 0.4763

Epoch 00031: val_loss did not improve from 1.42181
Epoch 32/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3552 - accuracy: 0.5104 - val_loss: 1.4273 - val_accuracy: 0.4773

Epoch 00032: val_loss did not improve from 1.42181
Epoch 33/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3501 - accuracy: 0.5119 - val_loss: 1.4255 - val_accuracy: 0.4790

Epoch 00033: val_loss did not improve from 1.42181
Epoch 34/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3495 - accuracy: 0.5143 - val_loss: 1.4298 - val_accuracy: 0.4777

Epoch 00034: val_loss did not improve from 1.42181
Epoch 35/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3397 - accuracy: 0.5181 - val_loss: 1.4330 - val_accuracy: 0.4754

Epoch 00035: val_loss did not improve from 1.42181
Epoch 36/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3342 - accuracy: 0.5219 - val_loss: 1.4379 - val_accuracy: 0.4738

Epoch 00036: val_loss did not improve from 1.42181
Epoch 37/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3261 - accuracy: 0.5289 - val_loss: 1.4431 - val_accuracy: 0.4731

Epoch 00037: val_loss did not improve from 1.42181
Epoch 38/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3157 - accuracy: 0.5349 - val_loss: 1.4454 - val_accuracy: 0.4714

Epoch 00038: val_loss did not improve from 1.42181
Epoch 00038: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN_2jet"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential (Sequential)      (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92msequential_1 (Sequential)    (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_4 (Dense)              multiple                  6150      [0m
[92m=================================================================[0m
[92mTotal params: 24,261,974[0m
[92mTrainable params: 24,261,966[0m
[92mNon-trainable params: 8[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda (Lambda)              (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization (BatchNo (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d (Conv2D)              (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d (MaxPooling2D) (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_1 (Conv2D)            (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_1 (MaxPooling2 (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_2 (Conv2D)            (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_2 (MaxPooling2 (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout (Dropout)            (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten (Flatten)            (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense (Dense)                (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_1 (Dropout)          (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_1 (Dense)              (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_2 (Dropout)          (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQChQJm\nBBkAUwApA07pAAAAAOkCAAAAqQCpAdoBeHIDAAAAcgMAAAD6Hy9ob21lL3NhbWh1YW5nL01ML0NO\nTi9tb2RlbHMucHnaCDxsYW1iZGE+KAEAAPMAAAAA\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_1', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_1', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_2', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_2', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_1', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_1', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_2', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_1"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_1 (Lambda)            (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_1 (Batch (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_3 (Conv2D)            (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_3 (MaxPooling2 (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_4 (Conv2D)            (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_4 (MaxPooling2 (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_5 (Conv2D)            (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_5 (MaxPooling2 (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_3 (Dropout)          (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_1 (Flatten)          (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_2 (Dense)              (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_4 (Dropout)          (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_3 (Dense)              (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_5 (Dropout)          (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_1', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_1_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_1', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQAhQJm\nBBkAUwCpAk7pAgAAAKkAqQHaAXhyAwAAAHIDAAAA+h8vaG9tZS9zYW1odWFuZy9NTC9DTk4vbW9k\nZWxzLnB52gg8bGFtYmRhPjoBAADzAAAAAA==\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_1', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_3', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_3', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_4', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_4', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_5', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_5', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_3', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_1', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_2', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_4', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_3', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_5', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER3       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_4', 'trainable': True, 'dtype': 'float32', 'units': 6, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
15062/15062 [==============================] - 98s 6ms/step - loss: 1.4180 - accuracy: 0.4742
Testing Loss = 1.418029, Testing Accuracy = 0.474173
The data set contains images
The data set contains images
The data set contains images
Number of training datasets: 48196.
Epoch 1/100
94/94 [==============================] - 14s 134ms/step - loss: 21.0149 - accuracy: 0.2423 - val_loss: 13.2406 - val_accuracy: 0.2710

Epoch 00001: val_loss improved from inf to 13.24055, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 2/100
94/94 [==============================] - 12s 132ms/step - loss: 9.9915 - accuracy: 0.2689 - val_loss: 7.6770 - val_accuracy: 0.2768

Epoch 00002: val_loss improved from 13.24055 to 7.67703, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 3/100
94/94 [==============================] - 13s 133ms/step - loss: 6.4629 - accuracy: 0.2811 - val_loss: 5.4573 - val_accuracy: 0.2847

Epoch 00003: val_loss improved from 7.67703 to 5.45732, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 4/100
94/94 [==============================] - 13s 135ms/step - loss: 4.7759 - accuracy: 0.2914 - val_loss: 4.1679 - val_accuracy: 0.2891

Epoch 00004: val_loss improved from 5.45732 to 4.16791, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 5/100
94/94 [==============================] - 13s 133ms/step - loss: 3.6457 - accuracy: 0.3538 - val_loss: 3.2384 - val_accuracy: 0.3685

Epoch 00005: val_loss improved from 4.16791 to 3.23842, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 6/100
94/94 [==============================] - 13s 133ms/step - loss: 2.9049 - accuracy: 0.3796 - val_loss: 2.6354 - val_accuracy: 0.3895

Epoch 00006: val_loss improved from 3.23842 to 2.63539, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 7/100
94/94 [==============================] - 13s 133ms/step - loss: 2.4278 - accuracy: 0.3879 - val_loss: 2.2440 - val_accuracy: 0.3984

Epoch 00007: val_loss improved from 2.63539 to 2.24401, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 8/100
94/94 [==============================] - 13s 133ms/step - loss: 2.1129 - accuracy: 0.3919 - val_loss: 1.9879 - val_accuracy: 0.4017

Epoch 00008: val_loss improved from 2.24401 to 1.98793, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 9/100
94/94 [==============================] - 13s 133ms/step - loss: 1.9065 - accuracy: 0.3946 - val_loss: 1.8213 - val_accuracy: 0.4023

Epoch 00009: val_loss improved from 1.98793 to 1.82129, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 10/100
94/94 [==============================] - 12s 132ms/step - loss: 1.7672 - accuracy: 0.3980 - val_loss: 1.7153 - val_accuracy: 0.4026

Epoch 00010: val_loss improved from 1.82129 to 1.71526, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 11/100
94/94 [==============================] - 13s 134ms/step - loss: 1.6778 - accuracy: 0.4008 - val_loss: 1.6415 - val_accuracy: 0.4012

Epoch 00011: val_loss improved from 1.71526 to 1.64149, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 12/100
94/94 [==============================] - 13s 134ms/step - loss: 1.6183 - accuracy: 0.4033 - val_loss: 1.5941 - val_accuracy: 0.4054

Epoch 00012: val_loss improved from 1.64149 to 1.59412, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 13/100
94/94 [==============================] - 13s 133ms/step - loss: 1.5776 - accuracy: 0.4076 - val_loss: 1.5659 - val_accuracy: 0.4094

Epoch 00013: val_loss improved from 1.59412 to 1.56586, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 14/100
94/94 [==============================] - 13s 133ms/step - loss: 1.5495 - accuracy: 0.4103 - val_loss: 1.5439 - val_accuracy: 0.4078

Epoch 00014: val_loss improved from 1.56586 to 1.54390, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 15/100
94/94 [==============================] - 13s 133ms/step - loss: 1.5325 - accuracy: 0.4156 - val_loss: 1.5233 - val_accuracy: 0.4182

Epoch 00015: val_loss improved from 1.54390 to 1.52329, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 16/100
94/94 [==============================] - 13s 134ms/step - loss: 1.4961 - accuracy: 0.4328 - val_loss: 1.4642 - val_accuracy: 0.4481

Epoch 00016: val_loss improved from 1.52329 to 1.46420, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 17/100
94/94 [==============================] - 13s 133ms/step - loss: 1.4594 - accuracy: 0.4542 - val_loss: 1.4430 - val_accuracy: 0.4620

Epoch 00017: val_loss improved from 1.46420 to 1.44301, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 18/100
94/94 [==============================] - 13s 133ms/step - loss: 1.4406 - accuracy: 0.4635 - val_loss: 1.4348 - val_accuracy: 0.4643

Epoch 00018: val_loss improved from 1.44301 to 1.43478, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 19/100
94/94 [==============================] - 13s 133ms/step - loss: 1.4280 - accuracy: 0.4703 - val_loss: 1.4306 - val_accuracy: 0.4660

Epoch 00019: val_loss improved from 1.43478 to 1.43056, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 20/100
94/94 [==============================] - 13s 133ms/step - loss: 1.4174 - accuracy: 0.4733 - val_loss: 1.4217 - val_accuracy: 0.4710

Epoch 00020: val_loss improved from 1.43056 to 1.42173, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 21/100
94/94 [==============================] - 13s 134ms/step - loss: 1.4110 - accuracy: 0.4769 - val_loss: 1.4180 - val_accuracy: 0.4718

Epoch 00021: val_loss improved from 1.42173 to 1.41797, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 22/100
94/94 [==============================] - 15s 157ms/step - loss: 1.4075 - accuracy: 0.4750 - val_loss: 1.4198 - val_accuracy: 0.4732

Epoch 00022: val_loss did not improve from 1.41797
Epoch 23/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3991 - accuracy: 0.4825 - val_loss: 1.4177 - val_accuracy: 0.4737

Epoch 00023: val_loss improved from 1.41797 to 1.41773, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 24/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3942 - accuracy: 0.4842 - val_loss: 1.4144 - val_accuracy: 0.4765

Epoch 00024: val_loss improved from 1.41773 to 1.41445, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 25/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3875 - accuracy: 0.4870 - val_loss: 1.4217 - val_accuracy: 0.4727

Epoch 00025: val_loss did not improve from 1.41445
Epoch 26/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3846 - accuracy: 0.4898 - val_loss: 1.4169 - val_accuracy: 0.4763

Epoch 00026: val_loss did not improve from 1.41445
Epoch 27/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3799 - accuracy: 0.4938 - val_loss: 1.4233 - val_accuracy: 0.4716

Epoch 00027: val_loss did not improve from 1.41445
Epoch 28/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3773 - accuracy: 0.4938 - val_loss: 1.4227 - val_accuracy: 0.4716

Epoch 00028: val_loss did not improve from 1.41445
Epoch 29/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3695 - accuracy: 0.4985 - val_loss: 1.4278 - val_accuracy: 0.4721

Epoch 00029: val_loss did not improve from 1.41445
Epoch 30/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3693 - accuracy: 0.4988 - val_loss: 1.4196 - val_accuracy: 0.4755

Epoch 00030: val_loss did not improve from 1.41445
Epoch 31/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3641 - accuracy: 0.5010 - val_loss: 1.4202 - val_accuracy: 0.4766

Epoch 00031: val_loss did not improve from 1.41445
Epoch 32/100
94/94 [==============================] - 13s 136ms/step - loss: 1.3556 - accuracy: 0.5063 - val_loss: 1.4135 - val_accuracy: 0.4813

Epoch 00032: val_loss improved from 1.41445 to 1.41354, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 33/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3532 - accuracy: 0.5078 - val_loss: 1.4196 - val_accuracy: 0.4784

Epoch 00033: val_loss did not improve from 1.41354
Epoch 34/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3470 - accuracy: 0.5133 - val_loss: 1.4111 - val_accuracy: 0.4824

Epoch 00034: val_loss improved from 1.41354 to 1.41107, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/1
Epoch 35/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3404 - accuracy: 0.5173 - val_loss: 1.4151 - val_accuracy: 0.4809

Epoch 00035: val_loss did not improve from 1.41107
Epoch 36/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3360 - accuracy: 0.5207 - val_loss: 1.4230 - val_accuracy: 0.4769

Epoch 00036: val_loss did not improve from 1.41107
Epoch 37/100
94/94 [==============================] - 13s 136ms/step - loss: 1.3297 - accuracy: 0.5245 - val_loss: 1.4205 - val_accuracy: 0.4800

Epoch 00037: val_loss did not improve from 1.41107
Epoch 38/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3258 - accuracy: 0.5256 - val_loss: 1.4209 - val_accuracy: 0.4820

Epoch 00038: val_loss did not improve from 1.41107
Epoch 39/100
94/94 [==============================] - 13s 135ms/step - loss: 1.3165 - accuracy: 0.5302 - val_loss: 1.4265 - val_accuracy: 0.4794

Epoch 00039: val_loss did not improve from 1.41107
Epoch 40/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3117 - accuracy: 0.5343 - val_loss: 1.4440 - val_accuracy: 0.4696

Epoch 00040: val_loss did not improve from 1.41107
Epoch 41/100
94/94 [==============================] - 13s 134ms/step - loss: 1.3046 - accuracy: 0.5387 - val_loss: 1.4389 - val_accuracy: 0.4780

Epoch 00041: val_loss did not improve from 1.41107
Epoch 42/100
94/94 [==============================] - 13s 136ms/step - loss: 1.2913 - accuracy: 0.5479 - val_loss: 1.4410 - val_accuracy: 0.4804

Epoch 00042: val_loss did not improve from 1.41107
Epoch 43/100
94/94 [==============================] - 13s 135ms/step - loss: 1.2881 - accuracy: 0.5508 - val_loss: 1.4527 - val_accuracy: 0.4737

Epoch 00043: val_loss did not improve from 1.41107
Epoch 44/100
94/94 [==============================] - 13s 136ms/step - loss: 1.2788 - accuracy: 0.5549 - val_loss: 1.4684 - val_accuracy: 0.4682

Epoch 00044: val_loss did not improve from 1.41107
Epoch 00044: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN_2jet"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential_2 (Sequential)    (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92msequential_3 (Sequential)    (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_9 (Dense)              multiple                  6150      [0m
[92m=================================================================[0m
[92mTotal params: 24,261,974[0m
[92mTrainable params: 24,261,966[0m
[92mNon-trainable params: 8[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_2"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_2 (Lambda)            (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_2 (Batch (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_6 (Conv2D)            (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_6 (MaxPooling2 (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_7 (Conv2D)            (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_7 (MaxPooling2 (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_8 (Conv2D)            (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_8 (MaxPooling2 (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_6 (Dropout)          (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_2 (Flatten)          (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_5 (Dense)              (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_7 (Dropout)          (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_6 (Dense)              (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_8 (Dropout)          (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_2', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_2_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_2', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQChQJm\nBBkAUwApA07pAAAAAOkCAAAAqQCpAdoBeHIDAAAAcgMAAAD6Hy9ob21lL3NhbWh1YW5nL01ML0NO\nTi9tb2RlbHMucHnaCDxsYW1iZGE+KAEAAPMAAAAA\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_2', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_6', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_6', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_7', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_7', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_8', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_8', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_6', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_2', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_5', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_7', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_6', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_8', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_3"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_3 (Lambda)            (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_3 (Batch (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_9 (Conv2D)            (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_9 (MaxPooling2 (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_10 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_10 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_11 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_11 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_9 (Dropout)          (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_3 (Flatten)          (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_7 (Dense)              (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_10 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_8 (Dense)              (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_11 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_3', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_3_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_3', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQAhQJm\nBBkAUwCpAk7pAgAAAKkAqQHaAXhyAwAAAHIDAAAA+h8vaG9tZS9zYW1odWFuZy9NTC9DTk4vbW9k\nZWxzLnB52gg8bGFtYmRhPjoBAADzAAAAAA==\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_3', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_9', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_9', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_10', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_10', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_11', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_11', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_9', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_3', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_7', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_10', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_8', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_11', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER3       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_9', 'trainable': True, 'dtype': 'float32', 'units': 6, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
15062/15062 [==============================] - 98s 7ms/step - loss: 1.4119 - accuracy: 0.4800
Testing Loss = 1.411906, Testing Accuracy = 0.480016
The data set contains images
The data set contains images
The data set contains images
Number of training datasets: 48196.
Epoch 1/100
94/94 [==============================] - 14s 137ms/step - loss: 20.9856 - accuracy: 0.2418 - val_loss: 13.2021 - val_accuracy: 0.2664

Epoch 00001: val_loss improved from inf to 13.20209, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 2/100
94/94 [==============================] - 13s 135ms/step - loss: 9.9563 - accuracy: 0.2721 - val_loss: 7.6503 - val_accuracy: 0.2780

Epoch 00002: val_loss improved from 13.20209 to 7.65029, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 3/100
94/94 [==============================] - 13s 136ms/step - loss: 6.4377 - accuracy: 0.2868 - val_loss: 5.4371 - val_accuracy: 0.2916

Epoch 00003: val_loss improved from 7.65029 to 5.43708, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 4/100
94/94 [==============================] - 13s 136ms/step - loss: 4.6983 - accuracy: 0.3408 - val_loss: 4.0952 - val_accuracy: 0.3544

Epoch 00004: val_loss improved from 5.43708 to 4.09524, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 5/100
94/94 [==============================] - 13s 136ms/step - loss: 3.5989 - accuracy: 0.3762 - val_loss: 3.2207 - val_accuracy: 0.3774

Epoch 00005: val_loss improved from 4.09524 to 3.22067, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 6/100
94/94 [==============================] - 13s 136ms/step - loss: 2.9000 - accuracy: 0.3836 - val_loss: 2.6348 - val_accuracy: 0.3927

Epoch 00006: val_loss improved from 3.22067 to 2.63485, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 7/100
94/94 [==============================] - 13s 136ms/step - loss: 2.4300 - accuracy: 0.3894 - val_loss: 2.2508 - val_accuracy: 0.3942

Epoch 00007: val_loss improved from 2.63485 to 2.25079, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 8/100
94/94 [==============================] - 13s 136ms/step - loss: 2.1183 - accuracy: 0.3924 - val_loss: 1.9957 - val_accuracy: 0.3927

Epoch 00008: val_loss improved from 2.25079 to 1.99567, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 9/100
94/94 [==============================] - 13s 135ms/step - loss: 1.9103 - accuracy: 0.3960 - val_loss: 1.8267 - val_accuracy: 0.3995

Epoch 00009: val_loss improved from 1.99567 to 1.82668, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 10/100
94/94 [==============================] - 13s 136ms/step - loss: 1.7760 - accuracy: 0.3959 - val_loss: 1.7183 - val_accuracy: 0.4002

Epoch 00010: val_loss improved from 1.82668 to 1.71827, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 11/100
94/94 [==============================] - 13s 137ms/step - loss: 1.6832 - accuracy: 0.4003 - val_loss: 1.6451 - val_accuracy: 0.4025

Epoch 00011: val_loss improved from 1.71827 to 1.64509, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 12/100
94/94 [==============================] - 13s 136ms/step - loss: 1.6226 - accuracy: 0.4036 - val_loss: 1.5997 - val_accuracy: 0.4056

Epoch 00012: val_loss improved from 1.64509 to 1.59968, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 13/100
94/94 [==============================] - 13s 135ms/step - loss: 1.5831 - accuracy: 0.4074 - val_loss: 1.5675 - val_accuracy: 0.4074

Epoch 00013: val_loss improved from 1.59968 to 1.56750, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 14/100
94/94 [==============================] - 13s 136ms/step - loss: 1.5564 - accuracy: 0.4082 - val_loss: 1.5484 - val_accuracy: 0.4074

Epoch 00014: val_loss improved from 1.56750 to 1.54844, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 15/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5365 - accuracy: 0.4099 - val_loss: 1.5322 - val_accuracy: 0.4128

Epoch 00015: val_loss improved from 1.54844 to 1.53221, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 16/100
94/94 [==============================] - 13s 136ms/step - loss: 1.5220 - accuracy: 0.4160 - val_loss: 1.5183 - val_accuracy: 0.4153

Epoch 00016: val_loss improved from 1.53221 to 1.51828, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 17/100
94/94 [==============================] - 13s 136ms/step - loss: 1.5077 - accuracy: 0.4198 - val_loss: 1.5105 - val_accuracy: 0.4174

Epoch 00017: val_loss improved from 1.51828 to 1.51054, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 18/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4991 - accuracy: 0.4237 - val_loss: 1.5056 - val_accuracy: 0.4176

Epoch 00018: val_loss improved from 1.51054 to 1.50560, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 19/100
94/94 [==============================] - 13s 135ms/step - loss: 1.4880 - accuracy: 0.4260 - val_loss: 1.5005 - val_accuracy: 0.4192

Epoch 00019: val_loss improved from 1.50560 to 1.50048, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 20/100
94/94 [==============================] - 13s 135ms/step - loss: 1.4847 - accuracy: 0.4272 - val_loss: 1.4950 - val_accuracy: 0.4209

Epoch 00020: val_loss improved from 1.50048 to 1.49502, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 21/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4759 - accuracy: 0.4311 - val_loss: 1.4905 - val_accuracy: 0.4231

Epoch 00021: val_loss improved from 1.49502 to 1.49053, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 22/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4703 - accuracy: 0.4339 - val_loss: 1.4951 - val_accuracy: 0.4201

Epoch 00022: val_loss did not improve from 1.49053
Epoch 23/100
94/94 [==============================] - 13s 135ms/step - loss: 1.4651 - accuracy: 0.4355 - val_loss: 1.4829 - val_accuracy: 0.4294

Epoch 00023: val_loss improved from 1.49053 to 1.48293, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 24/100
94/94 [==============================] - 13s 135ms/step - loss: 1.4610 - accuracy: 0.4387 - val_loss: 1.4911 - val_accuracy: 0.4212

Epoch 00024: val_loss did not improve from 1.48293
Epoch 25/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4579 - accuracy: 0.4397 - val_loss: 1.4907 - val_accuracy: 0.4215

Epoch 00025: val_loss did not improve from 1.48293
Epoch 26/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4528 - accuracy: 0.4412 - val_loss: 1.4871 - val_accuracy: 0.4244

Epoch 00026: val_loss did not improve from 1.48293
Epoch 27/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4489 - accuracy: 0.4428 - val_loss: 1.4877 - val_accuracy: 0.4258

Epoch 00027: val_loss did not improve from 1.48293
Epoch 28/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4428 - accuracy: 0.4487 - val_loss: 1.4829 - val_accuracy: 0.4265

Epoch 00028: val_loss improved from 1.48293 to 1.48291, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/2
Epoch 29/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4417 - accuracy: 0.4506 - val_loss: 1.4913 - val_accuracy: 0.4224

Epoch 00029: val_loss did not improve from 1.48291
Epoch 30/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4370 - accuracy: 0.4524 - val_loss: 1.4999 - val_accuracy: 0.4186

Epoch 00030: val_loss did not improve from 1.48291
Epoch 31/100
94/94 [==============================] - 13s 135ms/step - loss: 1.4328 - accuracy: 0.4550 - val_loss: 1.4846 - val_accuracy: 0.4305

Epoch 00031: val_loss did not improve from 1.48291
Epoch 32/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4298 - accuracy: 0.4557 - val_loss: 1.4906 - val_accuracy: 0.4256

Epoch 00032: val_loss did not improve from 1.48291
Epoch 33/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4246 - accuracy: 0.4612 - val_loss: 1.4900 - val_accuracy: 0.4259

Epoch 00033: val_loss did not improve from 1.48291
Epoch 00033: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN_2jet"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential_4 (Sequential)    (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92msequential_5 (Sequential)    (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_14 (Dense)             multiple                  6150      [0m
[92m=================================================================[0m
[92mTotal params: 24,261,974[0m
[92mTrainable params: 24,261,966[0m
[92mNon-trainable params: 8[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_4"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_4 (Lambda)            (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_4 (Batch (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_12 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_12 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_13 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_13 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_14 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_14 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_12 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_4 (Flatten)          (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_10 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_13 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_11 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_14 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_4', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_4_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_4', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQChQJm\nBBkAUwApA07pAAAAAOkCAAAAqQCpAdoBeHIDAAAAcgMAAAD6Hy9ob21lL3NhbWh1YW5nL01ML0NO\nTi9tb2RlbHMucHnaCDxsYW1iZGE+KAEAAPMAAAAA\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_4', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_12', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_12', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_13', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_13', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_14', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_14', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_12', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_4', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_10', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_13', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_11', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_14', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_5"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_5 (Lambda)            (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_5 (Batch (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_15 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_15 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_16 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_16 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_17 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_17 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_15 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_5 (Flatten)          (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_12 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_16 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_13 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_17 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_5', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_5_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_5', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQAhQJm\nBBkAUwCpAk7pAgAAAKkAqQHaAXhyAwAAAHIDAAAA+h8vaG9tZS9zYW1odWFuZy9NTC9DTk4vbW9k\nZWxzLnB52gg8bGFtYmRhPjoBAADzAAAAAA==\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_5', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_15', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_15', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_16', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_16', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_17', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_17', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_15', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_5', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_12', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_16', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_13', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_17', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER3       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_14', 'trainable': True, 'dtype': 'float32', 'units': 6, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
15062/15062 [==============================] - 102s 7ms/step - loss: 1.4817 - accuracy: 0.4294
Testing Loss = 1.481735, Testing Accuracy = 0.429425
The data set contains images
The data set contains images
The data set contains images
Number of training datasets: 48196.
Epoch 1/100
94/94 [==============================] - 14s 138ms/step - loss: 21.0333 - accuracy: 0.2402 - val_loss: 13.2531 - val_accuracy: 0.2678

Epoch 00001: val_loss improved from inf to 13.25308, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 2/100
94/94 [==============================] - 13s 135ms/step - loss: 10.0047 - accuracy: 0.2729 - val_loss: 7.6977 - val_accuracy: 0.2770

Epoch 00002: val_loss improved from 13.25308 to 7.69766, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 3/100
94/94 [==============================] - 13s 136ms/step - loss: 6.4686 - accuracy: 0.2995 - val_loss: 5.4647 - val_accuracy: 0.3105

Epoch 00003: val_loss improved from 7.69766 to 5.46467, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 4/100
94/94 [==============================] - 13s 135ms/step - loss: 4.7014 - accuracy: 0.3598 - val_loss: 4.1286 - val_accuracy: 0.3599

Epoch 00004: val_loss improved from 5.46467 to 4.12865, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 5/100
94/94 [==============================] - 13s 135ms/step - loss: 3.6328 - accuracy: 0.3797 - val_loss: 3.2533 - val_accuracy: 0.3832

Epoch 00005: val_loss improved from 4.12865 to 3.25330, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 6/100
94/94 [==============================] - 13s 135ms/step - loss: 2.9256 - accuracy: 0.3858 - val_loss: 2.6636 - val_accuracy: 0.3943

Epoch 00006: val_loss improved from 3.25330 to 2.66355, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 7/100
94/94 [==============================] - 13s 136ms/step - loss: 2.4536 - accuracy: 0.3903 - val_loss: 2.2762 - val_accuracy: 0.3928

Epoch 00007: val_loss improved from 2.66355 to 2.27622, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 8/100
94/94 [==============================] - 13s 138ms/step - loss: 2.1364 - accuracy: 0.3908 - val_loss: 2.0189 - val_accuracy: 0.3922

Epoch 00008: val_loss improved from 2.27622 to 2.01888, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 9/100
94/94 [==============================] - 13s 138ms/step - loss: 1.9220 - accuracy: 0.3949 - val_loss: 1.8351 - val_accuracy: 0.3967

Epoch 00009: val_loss improved from 2.01888 to 1.83514, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 10/100
94/94 [==============================] - 13s 137ms/step - loss: 1.7817 - accuracy: 0.3966 - val_loss: 1.7251 - val_accuracy: 0.3982

Epoch 00010: val_loss improved from 1.83514 to 1.72514, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 11/100
94/94 [==============================] - 13s 138ms/step - loss: 1.6890 - accuracy: 0.4018 - val_loss: 1.6576 - val_accuracy: 0.3973

Epoch 00011: val_loss improved from 1.72514 to 1.65764, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 12/100
94/94 [==============================] - 13s 139ms/step - loss: 1.6285 - accuracy: 0.4032 - val_loss: 1.6032 - val_accuracy: 0.4023

Epoch 00012: val_loss improved from 1.65764 to 1.60317, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 13/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5859 - accuracy: 0.4069 - val_loss: 1.5715 - val_accuracy: 0.4024

Epoch 00013: val_loss improved from 1.60317 to 1.57149, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 14/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5593 - accuracy: 0.4084 - val_loss: 1.5566 - val_accuracy: 0.4033

Epoch 00014: val_loss improved from 1.57149 to 1.55664, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 15/100
94/94 [==============================] - 13s 139ms/step - loss: 1.5387 - accuracy: 0.4096 - val_loss: 1.5369 - val_accuracy: 0.4067

Epoch 00015: val_loss improved from 1.55664 to 1.53688, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 16/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5245 - accuracy: 0.4138 - val_loss: 1.5212 - val_accuracy: 0.4136

Epoch 00016: val_loss improved from 1.53688 to 1.52124, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 17/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5105 - accuracy: 0.4190 - val_loss: 1.5145 - val_accuracy: 0.4153

Epoch 00017: val_loss improved from 1.52124 to 1.51448, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 18/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4992 - accuracy: 0.4214 - val_loss: 1.5082 - val_accuracy: 0.4161

Epoch 00018: val_loss improved from 1.51448 to 1.50824, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 19/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4916 - accuracy: 0.4259 - val_loss: 1.5041 - val_accuracy: 0.4149

Epoch 00019: val_loss improved from 1.50824 to 1.50408, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 20/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4856 - accuracy: 0.4294 - val_loss: 1.4948 - val_accuracy: 0.4226

Epoch 00020: val_loss improved from 1.50408 to 1.49476, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 21/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4793 - accuracy: 0.4300 - val_loss: 1.4996 - val_accuracy: 0.4153

Epoch 00021: val_loss did not improve from 1.49476
Epoch 22/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4732 - accuracy: 0.4334 - val_loss: 1.4941 - val_accuracy: 0.4178

Epoch 00022: val_loss improved from 1.49476 to 1.49413, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 23/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4674 - accuracy: 0.4393 - val_loss: 1.4967 - val_accuracy: 0.4177

Epoch 00023: val_loss did not improve from 1.49413
Epoch 24/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4632 - accuracy: 0.4397 - val_loss: 1.5009 - val_accuracy: 0.4147

Epoch 00024: val_loss did not improve from 1.49413
Epoch 25/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4603 - accuracy: 0.4398 - val_loss: 1.4928 - val_accuracy: 0.4179

Epoch 00025: val_loss improved from 1.49413 to 1.49283, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 26/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4559 - accuracy: 0.4412 - val_loss: 1.4930 - val_accuracy: 0.4191

Epoch 00026: val_loss did not improve from 1.49283
Epoch 27/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4506 - accuracy: 0.4475 - val_loss: 1.4920 - val_accuracy: 0.4186

Epoch 00027: val_loss improved from 1.49283 to 1.49195, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 28/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4466 - accuracy: 0.4467 - val_loss: 1.4962 - val_accuracy: 0.4179

Epoch 00028: val_loss did not improve from 1.49195
Epoch 29/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4442 - accuracy: 0.4492 - val_loss: 1.4945 - val_accuracy: 0.4199

Epoch 00029: val_loss did not improve from 1.49195
Epoch 30/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4410 - accuracy: 0.4515 - val_loss: 1.4926 - val_accuracy: 0.4222

Epoch 00030: val_loss did not improve from 1.49195
Epoch 31/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4337 - accuracy: 0.4548 - val_loss: 1.4973 - val_accuracy: 0.4173

Epoch 00031: val_loss did not improve from 1.49195
Epoch 32/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4301 - accuracy: 0.4568 - val_loss: 1.4890 - val_accuracy: 0.4255

Epoch 00032: val_loss improved from 1.49195 to 1.48904, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/3
Epoch 33/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4242 - accuracy: 0.4608 - val_loss: 1.4902 - val_accuracy: 0.4256

Epoch 00033: val_loss did not improve from 1.48904
Epoch 34/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4182 - accuracy: 0.4660 - val_loss: 1.4938 - val_accuracy: 0.4249

Epoch 00034: val_loss did not improve from 1.48904
Epoch 35/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4140 - accuracy: 0.4684 - val_loss: 1.4987 - val_accuracy: 0.4246

Epoch 00035: val_loss did not improve from 1.48904
Epoch 36/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4048 - accuracy: 0.4729 - val_loss: 1.5014 - val_accuracy: 0.4229

Epoch 00036: val_loss did not improve from 1.48904
Epoch 37/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4007 - accuracy: 0.4772 - val_loss: 1.5074 - val_accuracy: 0.4202

Epoch 00037: val_loss did not improve from 1.48904
Epoch 38/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3952 - accuracy: 0.4804 - val_loss: 1.5096 - val_accuracy: 0.4225

Epoch 00038: val_loss did not improve from 1.48904
Epoch 39/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3787 - accuracy: 0.4899 - val_loss: 1.5170 - val_accuracy: 0.4228

Epoch 00039: val_loss did not improve from 1.48904
Epoch 40/100
94/94 [==============================] - 13s 136ms/step - loss: 1.3727 - accuracy: 0.4948 - val_loss: 1.5244 - val_accuracy: 0.4233

Epoch 00040: val_loss did not improve from 1.48904
Epoch 41/100
94/94 [==============================] - 13s 136ms/step - loss: 1.3629 - accuracy: 0.5020 - val_loss: 1.5339 - val_accuracy: 0.4183

Epoch 00041: val_loss did not improve from 1.48904
Epoch 42/100
94/94 [==============================] - 13s 136ms/step - loss: 1.3503 - accuracy: 0.5101 - val_loss: 1.5432 - val_accuracy: 0.4192

Epoch 00042: val_loss did not improve from 1.48904
Epoch 00042: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN_2jet"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential_6 (Sequential)    (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92msequential_7 (Sequential)    (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_19 (Dense)             multiple                  6150      [0m
[92m=================================================================[0m
[92mTotal params: 24,261,974[0m
[92mTrainable params: 24,261,966[0m
[92mNon-trainable params: 8[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_6"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_6 (Lambda)            (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_6 (Batch (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_18 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_18 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_19 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_19 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_20 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_20 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_18 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_6 (Flatten)          (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_15 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_19 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_16 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_20 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_6', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_6_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_6', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQChQJm\nBBkAUwApA07pAAAAAOkCAAAAqQCpAdoBeHIDAAAAcgMAAAD6Hy9ob21lL3NhbWh1YW5nL01ML0NO\nTi9tb2RlbHMucHnaCDxsYW1iZGE+KAEAAPMAAAAA\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_6', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_18', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_18', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_19', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_19', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_20', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_20', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_18', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_6', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_15', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_19', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_16', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_20', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_7"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_7 (Lambda)            (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_7 (Batch (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_21 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_21 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_22 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_22 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_23 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_23 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_21 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_7 (Flatten)          (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_17 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_22 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_18 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_23 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_7', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_7_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_7', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQAhQJm\nBBkAUwCpAk7pAgAAAKkAqQHaAXhyAwAAAHIDAAAA+h8vaG9tZS9zYW1odWFuZy9NTC9DTk4vbW9k\nZWxzLnB52gg8bGFtYmRhPjoBAADzAAAAAA==\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_7', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_21', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_21', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_22', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_22', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_23', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_23', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_21', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_7', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_17', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_22', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_18', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_23', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER3       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_19', 'trainable': True, 'dtype': 'float32', 'units': 6, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
15062/15062 [==============================] - 99s 7ms/step - loss: 1.4886 - accuracy: 0.4278
Testing Loss = 1.488577, Testing Accuracy = 0.427832
The data set contains images
The data set contains images
The data set contains images
Number of training datasets: 48196.
Epoch 1/100
94/94 [==============================] - 14s 138ms/step - loss: 20.9269 - accuracy: 0.2347 - val_loss: 13.1263 - val_accuracy: 0.2663

Epoch 00001: val_loss improved from inf to 13.12627, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 2/100
94/94 [==============================] - 13s 134ms/step - loss: 9.9020 - accuracy: 0.2709 - val_loss: 7.6164 - val_accuracy: 0.2770

Epoch 00002: val_loss improved from 13.12627 to 7.61637, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 3/100
94/94 [==============================] - 13s 136ms/step - loss: 6.4130 - accuracy: 0.2908 - val_loss: 5.4217 - val_accuracy: 0.2977

Epoch 00003: val_loss improved from 7.61637 to 5.42174, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 4/100
94/94 [==============================] - 13s 135ms/step - loss: 4.6750 - accuracy: 0.3533 - val_loss: 4.1125 - val_accuracy: 0.3356

Epoch 00004: val_loss improved from 5.42174 to 4.11249, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 5/100
94/94 [==============================] - 13s 135ms/step - loss: 3.6054 - accuracy: 0.3763 - val_loss: 3.2278 - val_accuracy: 0.3745

Epoch 00005: val_loss improved from 4.11249 to 3.22785, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 6/100
94/94 [==============================] - 13s 136ms/step - loss: 2.9051 - accuracy: 0.3844 - val_loss: 2.6394 - val_accuracy: 0.3905

Epoch 00006: val_loss improved from 3.22785 to 2.63937, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 7/100
94/94 [==============================] - 13s 135ms/step - loss: 2.4368 - accuracy: 0.3883 - val_loss: 2.2562 - val_accuracy: 0.3916

Epoch 00007: val_loss improved from 2.63937 to 2.25617, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 8/100
94/94 [==============================] - 13s 135ms/step - loss: 2.1223 - accuracy: 0.3935 - val_loss: 2.0018 - val_accuracy: 0.3927

Epoch 00008: val_loss improved from 2.25617 to 2.00181, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 9/100
94/94 [==============================] - 13s 136ms/step - loss: 1.9129 - accuracy: 0.3938 - val_loss: 1.8256 - val_accuracy: 0.3991

Epoch 00009: val_loss improved from 2.00181 to 1.82564, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 10/100
94/94 [==============================] - 13s 135ms/step - loss: 1.7742 - accuracy: 0.3984 - val_loss: 1.7167 - val_accuracy: 0.4021

Epoch 00010: val_loss improved from 1.82564 to 1.71668, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 11/100
94/94 [==============================] - 13s 136ms/step - loss: 1.6831 - accuracy: 0.4003 - val_loss: 1.6486 - val_accuracy: 0.4004

Epoch 00011: val_loss improved from 1.71668 to 1.64860, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 12/100
94/94 [==============================] - 13s 137ms/step - loss: 1.6249 - accuracy: 0.4024 - val_loss: 1.6034 - val_accuracy: 0.4029

Epoch 00012: val_loss improved from 1.64860 to 1.60338, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 13/100
94/94 [==============================] - 13s 135ms/step - loss: 1.5848 - accuracy: 0.4051 - val_loss: 1.5733 - val_accuracy: 0.4068

Epoch 00013: val_loss improved from 1.60338 to 1.57332, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 14/100
94/94 [==============================] - 13s 136ms/step - loss: 1.5572 - accuracy: 0.4072 - val_loss: 1.5540 - val_accuracy: 0.4075

Epoch 00014: val_loss improved from 1.57332 to 1.55396, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 15/100
94/94 [==============================] - 13s 136ms/step - loss: 1.5377 - accuracy: 0.4101 - val_loss: 1.5345 - val_accuracy: 0.4095

Epoch 00015: val_loss improved from 1.55396 to 1.53445, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 16/100
94/94 [==============================] - 13s 136ms/step - loss: 1.5053 - accuracy: 0.4276 - val_loss: 1.4708 - val_accuracy: 0.4445

Epoch 00016: val_loss improved from 1.53445 to 1.47079, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 17/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4648 - accuracy: 0.4523 - val_loss: 1.4489 - val_accuracy: 0.4586

Epoch 00017: val_loss improved from 1.47079 to 1.44892, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 18/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4450 - accuracy: 0.4608 - val_loss: 1.4425 - val_accuracy: 0.4595

Epoch 00018: val_loss improved from 1.44892 to 1.44247, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 19/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4341 - accuracy: 0.4673 - val_loss: 1.4424 - val_accuracy: 0.4584

Epoch 00019: val_loss improved from 1.44247 to 1.44242, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 20/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4231 - accuracy: 0.4696 - val_loss: 1.4322 - val_accuracy: 0.4646

Epoch 00020: val_loss improved from 1.44242 to 1.43221, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 21/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4126 - accuracy: 0.4764 - val_loss: 1.4313 - val_accuracy: 0.4642

Epoch 00021: val_loss improved from 1.43221 to 1.43128, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 22/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4086 - accuracy: 0.4793 - val_loss: 1.4285 - val_accuracy: 0.4660

Epoch 00022: val_loss improved from 1.43128 to 1.42852, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 23/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4037 - accuracy: 0.4816 - val_loss: 1.4379 - val_accuracy: 0.4618

Epoch 00023: val_loss did not improve from 1.42852
Epoch 24/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3955 - accuracy: 0.4827 - val_loss: 1.4144 - val_accuracy: 0.4739

Epoch 00024: val_loss improved from 1.42852 to 1.41440, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/4
Epoch 25/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3874 - accuracy: 0.4896 - val_loss: 1.4260 - val_accuracy: 0.4672

Epoch 00025: val_loss did not improve from 1.41440
Epoch 26/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3840 - accuracy: 0.4912 - val_loss: 1.4299 - val_accuracy: 0.4671

Epoch 00026: val_loss did not improve from 1.41440
Epoch 27/100
94/94 [==============================] - 13s 139ms/step - loss: 1.3842 - accuracy: 0.4902 - val_loss: 1.4274 - val_accuracy: 0.4699

Epoch 00027: val_loss did not improve from 1.41440
Epoch 28/100
94/94 [==============================] - 13s 139ms/step - loss: 1.3759 - accuracy: 0.4964 - val_loss: 1.4288 - val_accuracy: 0.4691

Epoch 00028: val_loss did not improve from 1.41440
Epoch 29/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3704 - accuracy: 0.4990 - val_loss: 1.4234 - val_accuracy: 0.4712

Epoch 00029: val_loss did not improve from 1.41440
Epoch 30/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3622 - accuracy: 0.5041 - val_loss: 1.4150 - val_accuracy: 0.4735

Epoch 00030: val_loss did not improve from 1.41440
Epoch 31/100
94/94 [==============================] - 13s 136ms/step - loss: 1.3576 - accuracy: 0.5074 - val_loss: 1.4214 - val_accuracy: 0.4733

Epoch 00031: val_loss did not improve from 1.41440
Epoch 32/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3512 - accuracy: 0.5087 - val_loss: 1.4191 - val_accuracy: 0.4749

Epoch 00032: val_loss did not improve from 1.41440
Epoch 33/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3450 - accuracy: 0.5163 - val_loss: 1.4193 - val_accuracy: 0.4745

Epoch 00033: val_loss did not improve from 1.41440
Epoch 34/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3424 - accuracy: 0.5169 - val_loss: 1.4231 - val_accuracy: 0.4761

Epoch 00034: val_loss did not improve from 1.41440
Epoch 00034: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN_2jet"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential_8 (Sequential)    (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92msequential_9 (Sequential)    (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_24 (Dense)             multiple                  6150      [0m
[92m=================================================================[0m
[92mTotal params: 24,261,974[0m
[92mTrainable params: 24,261,966[0m
[92mNon-trainable params: 8[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_8"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_8 (Lambda)            (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_8 (Batch (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_24 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_24 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_25 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_25 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_26 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_26 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_24 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_8 (Flatten)          (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_20 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_25 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_21 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_26 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_8', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_8_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_8', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQChQJm\nBBkAUwApA07pAAAAAOkCAAAAqQCpAdoBeHIDAAAAcgMAAAD6Hy9ob21lL3NhbWh1YW5nL01ML0NO\nTi9tb2RlbHMucHnaCDxsYW1iZGE+KAEAAPMAAAAA\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_8', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_24', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_24', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_25', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_25', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_26', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_26', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_24', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_8', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_20', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_25', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_21', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_26', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_9"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_9 (Lambda)            (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_9 (Batch (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_27 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_27 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_28 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_28 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_29 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_29 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_27 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_9 (Flatten)          (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_22 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_28 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_23 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_29 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_9', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_9_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_9', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQAhQJm\nBBkAUwCpAk7pAgAAAKkAqQHaAXhyAwAAAHIDAAAA+h8vaG9tZS9zYW1odWFuZy9NTC9DTk4vbW9k\nZWxzLnB52gg8bGFtYmRhPjoBAADzAAAAAA==\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_9', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_27', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_27', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_28', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_28', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_29', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_29', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_27', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_9', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_22', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_28', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_23', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_29', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER3       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_24', 'trainable': True, 'dtype': 'float32', 'units': 6, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
15062/15062 [==============================] - 100s 7ms/step - loss: 1.4136 - accuracy: 0.4773
Testing Loss = 1.413600, Testing Accuracy = 0.477294
The data set contains images
The data set contains images
The data set contains images
Number of training datasets: 48196.
Epoch 1/100
94/94 [==============================] - 14s 137ms/step - loss: 21.0209 - accuracy: 0.2403 - val_loss: 13.2454 - val_accuracy: 0.2706

Epoch 00001: val_loss improved from inf to 13.24541, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 2/100
94/94 [==============================] - 13s 136ms/step - loss: 9.9962 - accuracy: 0.2817 - val_loss: 7.6965 - val_accuracy: 0.2782

Epoch 00002: val_loss improved from 13.24541 to 7.69650, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 3/100
94/94 [==============================] - 13s 137ms/step - loss: 6.4133 - accuracy: 0.3385 - val_loss: 5.4656 - val_accuracy: 0.3253

Epoch 00003: val_loss improved from 7.69650 to 5.46556, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 4/100
94/94 [==============================] - 13s 137ms/step - loss: 4.6913 - accuracy: 0.3707 - val_loss: 4.1359 - val_accuracy: 0.3693

Epoch 00004: val_loss improved from 5.46556 to 4.13592, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 5/100
94/94 [==============================] - 13s 138ms/step - loss: 3.6378 - accuracy: 0.3816 - val_loss: 3.2611 - val_accuracy: 0.3877

Epoch 00005: val_loss improved from 4.13592 to 3.26111, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 6/100
94/94 [==============================] - 13s 139ms/step - loss: 2.9347 - accuracy: 0.3861 - val_loss: 2.6717 - val_accuracy: 0.3929

Epoch 00006: val_loss improved from 3.26111 to 2.67166, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 7/100
94/94 [==============================] - 13s 137ms/step - loss: 2.4612 - accuracy: 0.3898 - val_loss: 2.2829 - val_accuracy: 0.3943

Epoch 00007: val_loss improved from 2.67166 to 2.28290, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 8/100
94/94 [==============================] - 13s 139ms/step - loss: 2.1429 - accuracy: 0.3936 - val_loss: 2.0129 - val_accuracy: 0.3988

Epoch 00008: val_loss improved from 2.28290 to 2.01290, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 9/100
94/94 [==============================] - 13s 138ms/step - loss: 1.9284 - accuracy: 0.3953 - val_loss: 1.8487 - val_accuracy: 0.3965

Epoch 00009: val_loss improved from 2.01290 to 1.84874, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 10/100
94/94 [==============================] - 13s 137ms/step - loss: 1.7865 - accuracy: 0.3966 - val_loss: 1.7333 - val_accuracy: 0.4002

Epoch 00010: val_loss improved from 1.84874 to 1.73331, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 11/100
94/94 [==============================] - 13s 138ms/step - loss: 1.6943 - accuracy: 0.4021 - val_loss: 1.6576 - val_accuracy: 0.4026

Epoch 00011: val_loss improved from 1.73331 to 1.65764, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 12/100
94/94 [==============================] - 13s 137ms/step - loss: 1.6311 - accuracy: 0.4041 - val_loss: 1.6110 - val_accuracy: 0.4029

Epoch 00012: val_loss improved from 1.65764 to 1.61102, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 13/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5892 - accuracy: 0.4052 - val_loss: 1.5785 - val_accuracy: 0.4056

Epoch 00013: val_loss improved from 1.61102 to 1.57854, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 14/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5615 - accuracy: 0.4089 - val_loss: 1.5572 - val_accuracy: 0.4074

Epoch 00014: val_loss improved from 1.57854 to 1.55715, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 15/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5405 - accuracy: 0.4130 - val_loss: 1.5403 - val_accuracy: 0.4098

Epoch 00015: val_loss improved from 1.55715 to 1.54029, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 16/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5230 - accuracy: 0.4192 - val_loss: 1.5258 - val_accuracy: 0.4133

Epoch 00016: val_loss improved from 1.54029 to 1.52583, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 17/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5103 - accuracy: 0.4211 - val_loss: 1.5151 - val_accuracy: 0.4197

Epoch 00017: val_loss improved from 1.52583 to 1.51509, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 18/100
94/94 [==============================] - 13s 136ms/step - loss: 1.5006 - accuracy: 0.4247 - val_loss: 1.5104 - val_accuracy: 0.4198

Epoch 00018: val_loss improved from 1.51509 to 1.51036, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 19/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4910 - accuracy: 0.4281 - val_loss: 1.5010 - val_accuracy: 0.4243

Epoch 00019: val_loss improved from 1.51036 to 1.50102, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 20/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4850 - accuracy: 0.4311 - val_loss: 1.4980 - val_accuracy: 0.4235

Epoch 00020: val_loss improved from 1.50102 to 1.49798, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 21/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4791 - accuracy: 0.4326 - val_loss: 1.4936 - val_accuracy: 0.4246

Epoch 00021: val_loss improved from 1.49798 to 1.49360, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 22/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4729 - accuracy: 0.4357 - val_loss: 1.4986 - val_accuracy: 0.4216

Epoch 00022: val_loss did not improve from 1.49360
Epoch 23/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4675 - accuracy: 0.4383 - val_loss: 1.4981 - val_accuracy: 0.4233

Epoch 00023: val_loss did not improve from 1.49360
Epoch 24/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4635 - accuracy: 0.4409 - val_loss: 1.4926 - val_accuracy: 0.4251

Epoch 00024: val_loss improved from 1.49360 to 1.49261, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 25/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4591 - accuracy: 0.4420 - val_loss: 1.4961 - val_accuracy: 0.4229

Epoch 00025: val_loss did not improve from 1.49261
Epoch 26/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4541 - accuracy: 0.4451 - val_loss: 1.4899 - val_accuracy: 0.4276

Epoch 00026: val_loss improved from 1.49261 to 1.48991, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/5
Epoch 27/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4475 - accuracy: 0.4495 - val_loss: 1.4947 - val_accuracy: 0.4225

Epoch 00027: val_loss did not improve from 1.48991
Epoch 28/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4451 - accuracy: 0.4493 - val_loss: 1.4922 - val_accuracy: 0.4248

Epoch 00028: val_loss did not improve from 1.48991
Epoch 29/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4428 - accuracy: 0.4520 - val_loss: 1.5017 - val_accuracy: 0.4209

Epoch 00029: val_loss did not improve from 1.48991
Epoch 30/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4371 - accuracy: 0.4563 - val_loss: 1.4922 - val_accuracy: 0.4256

Epoch 00030: val_loss did not improve from 1.48991
Epoch 31/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4313 - accuracy: 0.4589 - val_loss: 1.4964 - val_accuracy: 0.4249

Epoch 00031: val_loss did not improve from 1.48991
Epoch 32/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4210 - accuracy: 0.4638 - val_loss: 1.4964 - val_accuracy: 0.4271

Epoch 00032: val_loss did not improve from 1.48991
Epoch 33/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4195 - accuracy: 0.4672 - val_loss: 1.4938 - val_accuracy: 0.4280

Epoch 00033: val_loss did not improve from 1.48991
Epoch 34/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4157 - accuracy: 0.4718 - val_loss: 1.5039 - val_accuracy: 0.4232

Epoch 00034: val_loss did not improve from 1.48991
Epoch 35/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4075 - accuracy: 0.4763 - val_loss: 1.5042 - val_accuracy: 0.4264

Epoch 00035: val_loss did not improve from 1.48991
Epoch 36/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3975 - accuracy: 0.4817 - val_loss: 1.5114 - val_accuracy: 0.4257

Epoch 00036: val_loss did not improve from 1.48991
Epoch 00036: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN_2jet"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential_10 (Sequential)   (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92msequential_11 (Sequential)   (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_29 (Dense)             multiple                  6150      [0m
[92m=================================================================[0m
[92mTotal params: 24,261,974[0m
[92mTrainable params: 24,261,966[0m
[92mNon-trainable params: 8[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_10"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_10 (Lambda)           (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_10 (Batc (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_30 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_30 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_31 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_31 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_32 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_32 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_30 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_10 (Flatten)         (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_25 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_31 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_26 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_32 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_10', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_10_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_10', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQChQJm\nBBkAUwApA07pAAAAAOkCAAAAqQCpAdoBeHIDAAAAcgMAAAD6Hy9ob21lL3NhbWh1YW5nL01ML0NO\nTi9tb2RlbHMucHnaCDxsYW1iZGE+KAEAAPMAAAAA\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_10', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_30', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_30', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_31', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_31', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_32', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_32', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_30', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_10', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_25', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_31', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_26', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_32', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_11"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_11 (Lambda)           (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_11 (Batc (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_33 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_33 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_34 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_34 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_35 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_35 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_33 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_11 (Flatten)         (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_27 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_34 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_28 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_35 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_11', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_11_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_11', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQAhQJm\nBBkAUwCpAk7pAgAAAKkAqQHaAXhyAwAAAHIDAAAA+h8vaG9tZS9zYW1odWFuZy9NTC9DTk4vbW9k\nZWxzLnB52gg8bGFtYmRhPjoBAADzAAAAAA==\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_11', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_33', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_33', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_34', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_34', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_35', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_35', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_33', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_11', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_27', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_34', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_28', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_35', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER3       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_29', 'trainable': True, 'dtype': 'float32', 'units': 6, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
15062/15062 [==============================] - 100s 7ms/step - loss: 1.4910 - accuracy: 0.4280
Testing Loss = 1.490980, Testing Accuracy = 0.428031
The data set contains images
The data set contains images
The data set contains images
Number of training datasets: 48196.
Epoch 1/100
94/94 [==============================] - 14s 139ms/step - loss: 20.9771 - accuracy: 0.2379 - val_loss: 13.2016 - val_accuracy: 0.2648

Epoch 00001: val_loss improved from inf to 13.20155, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 2/100
94/94 [==============================] - 13s 137ms/step - loss: 9.9628 - accuracy: 0.2688 - val_loss: 7.6595 - val_accuracy: 0.2751

Epoch 00002: val_loss improved from 13.20155 to 7.65948, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 3/100
94/94 [==============================] - 13s 139ms/step - loss: 6.4495 - accuracy: 0.2842 - val_loss: 5.4505 - val_accuracy: 0.2886

Epoch 00003: val_loss improved from 7.65948 to 5.45054, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 4/100
94/94 [==============================] - 13s 138ms/step - loss: 4.7217 - accuracy: 0.3290 - val_loss: 4.1121 - val_accuracy: 0.3424

Epoch 00004: val_loss improved from 5.45054 to 4.11209, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 5/100
94/94 [==============================] - 13s 139ms/step - loss: 3.6111 - accuracy: 0.3733 - val_loss: 3.2359 - val_accuracy: 0.3697

Epoch 00005: val_loss improved from 4.11209 to 3.23595, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 6/100
94/94 [==============================] - 13s 139ms/step - loss: 2.9073 - accuracy: 0.3821 - val_loss: 2.6382 - val_accuracy: 0.3965

Epoch 00006: val_loss improved from 3.23595 to 2.63823, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 7/100
94/94 [==============================] - 13s 139ms/step - loss: 2.4355 - accuracy: 0.3881 - val_loss: 2.2585 - val_accuracy: 0.3920

Epoch 00007: val_loss improved from 2.63823 to 2.25848, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 8/100
94/94 [==============================] - 13s 139ms/step - loss: 2.1220 - accuracy: 0.3905 - val_loss: 1.9959 - val_accuracy: 0.3956

Epoch 00008: val_loss improved from 2.25848 to 1.99593, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 9/100
94/94 [==============================] - 13s 139ms/step - loss: 1.9095 - accuracy: 0.3963 - val_loss: 1.8297 - val_accuracy: 0.3944

Epoch 00009: val_loss improved from 1.99593 to 1.82970, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 10/100
94/94 [==============================] - 13s 139ms/step - loss: 1.7737 - accuracy: 0.3954 - val_loss: 1.7181 - val_accuracy: 0.4006

Epoch 00010: val_loss improved from 1.82970 to 1.71809, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 11/100
94/94 [==============================] - 13s 139ms/step - loss: 1.6819 - accuracy: 0.3997 - val_loss: 1.6458 - val_accuracy: 0.4043

Epoch 00011: val_loss improved from 1.71809 to 1.64575, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 12/100
94/94 [==============================] - 13s 139ms/step - loss: 1.6210 - accuracy: 0.4020 - val_loss: 1.5976 - val_accuracy: 0.4064

Epoch 00012: val_loss improved from 1.64575 to 1.59763, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 13/100
94/94 [==============================] - 13s 139ms/step - loss: 1.5803 - accuracy: 0.4057 - val_loss: 1.5677 - val_accuracy: 0.4071

Epoch 00013: val_loss improved from 1.59763 to 1.56773, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 14/100
94/94 [==============================] - 13s 139ms/step - loss: 1.5535 - accuracy: 0.4088 - val_loss: 1.5466 - val_accuracy: 0.4087

Epoch 00014: val_loss improved from 1.56773 to 1.54663, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 15/100
94/94 [==============================] - 13s 139ms/step - loss: 1.5336 - accuracy: 0.4133 - val_loss: 1.5330 - val_accuracy: 0.4121

Epoch 00015: val_loss improved from 1.54663 to 1.53297, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 16/100
94/94 [==============================] - 13s 140ms/step - loss: 1.5183 - accuracy: 0.4168 - val_loss: 1.5153 - val_accuracy: 0.4181

Epoch 00016: val_loss improved from 1.53297 to 1.51530, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 17/100
94/94 [==============================] - 13s 139ms/step - loss: 1.5043 - accuracy: 0.4212 - val_loss: 1.5093 - val_accuracy: 0.4200

Epoch 00017: val_loss improved from 1.51530 to 1.50930, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 18/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4961 - accuracy: 0.4252 - val_loss: 1.5048 - val_accuracy: 0.4193

Epoch 00018: val_loss improved from 1.50930 to 1.50481, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 19/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4882 - accuracy: 0.4257 - val_loss: 1.5019 - val_accuracy: 0.4158

Epoch 00019: val_loss improved from 1.50481 to 1.50190, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 20/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4826 - accuracy: 0.4283 - val_loss: 1.5031 - val_accuracy: 0.4164

Epoch 00020: val_loss did not improve from 1.50190
Epoch 21/100
94/94 [==============================] - 13s 140ms/step - loss: 1.4765 - accuracy: 0.4335 - val_loss: 1.4918 - val_accuracy: 0.4225

Epoch 00021: val_loss improved from 1.50190 to 1.49183, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 22/100
94/94 [==============================] - 13s 140ms/step - loss: 1.4722 - accuracy: 0.4315 - val_loss: 1.4884 - val_accuracy: 0.4233

Epoch 00022: val_loss improved from 1.49183 to 1.48843, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 23/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4673 - accuracy: 0.4342 - val_loss: 1.4937 - val_accuracy: 0.4193

Epoch 00023: val_loss did not improve from 1.48843
Epoch 24/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4604 - accuracy: 0.4370 - val_loss: 1.4912 - val_accuracy: 0.4203

Epoch 00024: val_loss did not improve from 1.48843
Epoch 25/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4583 - accuracy: 0.4399 - val_loss: 1.4886 - val_accuracy: 0.4246

Epoch 00025: val_loss did not improve from 1.48843
Epoch 26/100
94/94 [==============================] - 13s 140ms/step - loss: 1.4530 - accuracy: 0.4416 - val_loss: 1.4865 - val_accuracy: 0.4233

Epoch 00026: val_loss improved from 1.48843 to 1.48648, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 27/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4501 - accuracy: 0.4442 - val_loss: 1.4878 - val_accuracy: 0.4250

Epoch 00027: val_loss did not improve from 1.48648
Epoch 28/100
94/94 [==============================] - 13s 140ms/step - loss: 1.4447 - accuracy: 0.4462 - val_loss: 1.4941 - val_accuracy: 0.4202

Epoch 00028: val_loss did not improve from 1.48648
Epoch 29/100
94/94 [==============================] - 13s 140ms/step - loss: 1.4424 - accuracy: 0.4473 - val_loss: 1.4906 - val_accuracy: 0.4223

Epoch 00029: val_loss did not improve from 1.48648
Epoch 30/100
94/94 [==============================] - 13s 140ms/step - loss: 1.4369 - accuracy: 0.4514 - val_loss: 1.4921 - val_accuracy: 0.4225

Epoch 00030: val_loss did not improve from 1.48648
Epoch 31/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4352 - accuracy: 0.4541 - val_loss: 1.4910 - val_accuracy: 0.4234

Epoch 00031: val_loss did not improve from 1.48648
Epoch 32/100
94/94 [==============================] - 13s 140ms/step - loss: 1.4316 - accuracy: 0.4582 - val_loss: 1.4930 - val_accuracy: 0.4231

Epoch 00032: val_loss did not improve from 1.48648
Epoch 33/100
94/94 [==============================] - 13s 140ms/step - loss: 1.4264 - accuracy: 0.4589 - val_loss: 1.4863 - val_accuracy: 0.4245

Epoch 00033: val_loss improved from 1.48648 to 1.48625, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/6
Epoch 34/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4245 - accuracy: 0.4604 - val_loss: 1.4943 - val_accuracy: 0.4224

Epoch 00034: val_loss did not improve from 1.48625
Epoch 35/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4186 - accuracy: 0.4631 - val_loss: 1.4885 - val_accuracy: 0.4260

Epoch 00035: val_loss did not improve from 1.48625
Epoch 36/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4115 - accuracy: 0.4709 - val_loss: 1.4916 - val_accuracy: 0.4241

Epoch 00036: val_loss did not improve from 1.48625
Epoch 37/100
94/94 [==============================] - 13s 140ms/step - loss: 1.4046 - accuracy: 0.4734 - val_loss: 1.4993 - val_accuracy: 0.4229

Epoch 00037: val_loss did not improve from 1.48625
Epoch 38/100
94/94 [==============================] - 13s 140ms/step - loss: 1.3982 - accuracy: 0.4767 - val_loss: 1.5121 - val_accuracy: 0.4204

Epoch 00038: val_loss did not improve from 1.48625
Epoch 39/100
94/94 [==============================] - 13s 140ms/step - loss: 1.3906 - accuracy: 0.4812 - val_loss: 1.5148 - val_accuracy: 0.4215

Epoch 00039: val_loss did not improve from 1.48625
Epoch 40/100
94/94 [==============================] - 13s 140ms/step - loss: 1.3827 - accuracy: 0.4894 - val_loss: 1.5136 - val_accuracy: 0.4206

Epoch 00040: val_loss did not improve from 1.48625
Epoch 41/100
94/94 [==============================] - 13s 139ms/step - loss: 1.3757 - accuracy: 0.4924 - val_loss: 1.5213 - val_accuracy: 0.4178

Epoch 00041: val_loss did not improve from 1.48625
Epoch 42/100
94/94 [==============================] - 13s 139ms/step - loss: 1.3641 - accuracy: 0.5018 - val_loss: 1.5242 - val_accuracy: 0.4173

Epoch 00042: val_loss did not improve from 1.48625
Epoch 43/100
94/94 [==============================] - 13s 140ms/step - loss: 1.3533 - accuracy: 0.5066 - val_loss: 1.5338 - val_accuracy: 0.4175

Epoch 00043: val_loss did not improve from 1.48625
Epoch 00043: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN_2jet"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential_12 (Sequential)   (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92msequential_13 (Sequential)   (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_34 (Dense)             multiple                  6150      [0m
[92m=================================================================[0m
[92mTotal params: 24,261,974[0m
[92mTrainable params: 24,261,966[0m
[92mNon-trainable params: 8[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_12"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_12 (Lambda)           (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_12 (Batc (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_36 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_36 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_37 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_37 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_38 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_38 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_36 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_12 (Flatten)         (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_30 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_37 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_31 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_38 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_12', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_12_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_12', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQChQJm\nBBkAUwApA07pAAAAAOkCAAAAqQCpAdoBeHIDAAAAcgMAAAD6Hy9ob21lL3NhbWh1YW5nL01ML0NO\nTi9tb2RlbHMucHnaCDxsYW1iZGE+KAEAAPMAAAAA\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_12', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_36', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_36', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_37', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_37', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_38', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_38', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_36', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_12', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_30', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_37', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_31', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_38', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_13"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_13 (Lambda)           (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_13 (Batc (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_39 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_39 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_40 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_40 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_41 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_41 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_39 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_13 (Flatten)         (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_32 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_40 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_33 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_41 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_13', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_13_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_13', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQAhQJm\nBBkAUwCpAk7pAgAAAKkAqQHaAXhyAwAAAHIDAAAA+h8vaG9tZS9zYW1odWFuZy9NTC9DTk4vbW9k\nZWxzLnB52gg8bGFtYmRhPjoBAADzAAAAAA==\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_13', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_39', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_39', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_40', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_40', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_41', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_41', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_39', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_13', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_32', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_40', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_33', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_41', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER3       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_34', 'trainable': True, 'dtype': 'float32', 'units': 6, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
15062/15062 [==============================] - 99s 7ms/step - loss: 1.4833 - accuracy: 0.4283
Testing Loss = 1.483314, Testing Accuracy = 0.428296
The data set contains images
The data set contains images
The data set contains images
Number of training datasets: 48196.
Epoch 1/100
94/94 [==============================] - 14s 139ms/step - loss: 21.0287 - accuracy: 0.2410 - val_loss: 13.2555 - val_accuracy: 0.2702

Epoch 00001: val_loss improved from inf to 13.25549, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 2/100
94/94 [==============================] - 13s 137ms/step - loss: 10.0012 - accuracy: 0.2760 - val_loss: 7.6929 - val_accuracy: 0.2789

Epoch 00002: val_loss improved from 13.25549 to 7.69295, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 3/100
94/94 [==============================] - 13s 137ms/step - loss: 6.4497 - accuracy: 0.3063 - val_loss: 5.4895 - val_accuracy: 0.2782

Epoch 00003: val_loss improved from 7.69295 to 5.48950, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 4/100
94/94 [==============================] - 13s 137ms/step - loss: 4.6845 - accuracy: 0.3651 - val_loss: 4.1266 - val_accuracy: 0.3539

Epoch 00004: val_loss improved from 5.48950 to 4.12663, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 5/100
94/94 [==============================] - 13s 139ms/step - loss: 3.6223 - accuracy: 0.3803 - val_loss: 3.2512 - val_accuracy: 0.3734

Epoch 00005: val_loss improved from 4.12663 to 3.25119, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 6/100
94/94 [==============================] - 13s 138ms/step - loss: 2.9208 - accuracy: 0.3822 - val_loss: 2.6530 - val_accuracy: 0.3916

Epoch 00006: val_loss improved from 3.25119 to 2.65303, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 7/100
94/94 [==============================] - 13s 139ms/step - loss: 2.4482 - accuracy: 0.3881 - val_loss: 2.2653 - val_accuracy: 0.3938

Epoch 00007: val_loss improved from 2.65303 to 2.26532, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 8/100
94/94 [==============================] - 13s 138ms/step - loss: 2.1329 - accuracy: 0.3917 - val_loss: 2.0081 - val_accuracy: 0.3986

Epoch 00008: val_loss improved from 2.26532 to 2.00815, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 9/100
94/94 [==============================] - 13s 138ms/step - loss: 1.9211 - accuracy: 0.3976 - val_loss: 1.8395 - val_accuracy: 0.3968

Epoch 00009: val_loss improved from 2.00815 to 1.83949, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 10/100
94/94 [==============================] - 13s 138ms/step - loss: 1.7801 - accuracy: 0.3971 - val_loss: 1.7296 - val_accuracy: 0.3976

Epoch 00010: val_loss improved from 1.83949 to 1.72960, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 11/100
94/94 [==============================] - 13s 138ms/step - loss: 1.6895 - accuracy: 0.4000 - val_loss: 1.6531 - val_accuracy: 0.4034

Epoch 00011: val_loss improved from 1.72960 to 1.65312, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 12/100
94/94 [==============================] - 13s 139ms/step - loss: 1.6272 - accuracy: 0.4031 - val_loss: 1.6058 - val_accuracy: 0.4038

Epoch 00012: val_loss improved from 1.65312 to 1.60575, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 13/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5846 - accuracy: 0.4063 - val_loss: 1.5768 - val_accuracy: 0.4074

Epoch 00013: val_loss improved from 1.60575 to 1.57680, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 14/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5606 - accuracy: 0.4046 - val_loss: 1.5547 - val_accuracy: 0.4088

Epoch 00014: val_loss improved from 1.57680 to 1.55472, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 15/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5423 - accuracy: 0.4110 - val_loss: 1.5482 - val_accuracy: 0.4033

Epoch 00015: val_loss improved from 1.55472 to 1.54820, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 16/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5273 - accuracy: 0.4128 - val_loss: 1.5287 - val_accuracy: 0.4117

Epoch 00016: val_loss improved from 1.54820 to 1.52869, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 17/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5142 - accuracy: 0.4170 - val_loss: 1.5227 - val_accuracy: 0.4075

Epoch 00017: val_loss improved from 1.52869 to 1.52271, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 18/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5038 - accuracy: 0.4210 - val_loss: 1.5093 - val_accuracy: 0.4196

Epoch 00018: val_loss improved from 1.52271 to 1.50925, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 19/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4952 - accuracy: 0.4231 - val_loss: 1.5079 - val_accuracy: 0.4169

Epoch 00019: val_loss improved from 1.50925 to 1.50792, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 20/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4860 - accuracy: 0.4294 - val_loss: 1.5021 - val_accuracy: 0.4192

Epoch 00020: val_loss improved from 1.50792 to 1.50208, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 21/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4807 - accuracy: 0.4304 - val_loss: 1.5054 - val_accuracy: 0.4175

Epoch 00021: val_loss did not improve from 1.50208
Epoch 22/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4742 - accuracy: 0.4350 - val_loss: 1.4970 - val_accuracy: 0.4218

Epoch 00022: val_loss improved from 1.50208 to 1.49700, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 23/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4683 - accuracy: 0.4373 - val_loss: 1.4962 - val_accuracy: 0.4224

Epoch 00023: val_loss improved from 1.49700 to 1.49623, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 24/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4642 - accuracy: 0.4390 - val_loss: 1.4901 - val_accuracy: 0.4241

Epoch 00024: val_loss improved from 1.49623 to 1.49011, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 25/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4594 - accuracy: 0.4398 - val_loss: 1.4905 - val_accuracy: 0.4260

Epoch 00025: val_loss did not improve from 1.49011
Epoch 26/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4565 - accuracy: 0.4430 - val_loss: 1.4908 - val_accuracy: 0.4248

Epoch 00026: val_loss did not improve from 1.49011
Epoch 27/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4528 - accuracy: 0.4441 - val_loss: 1.4885 - val_accuracy: 0.4243

Epoch 00027: val_loss improved from 1.49011 to 1.48852, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/7
Epoch 28/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4472 - accuracy: 0.4478 - val_loss: 1.4901 - val_accuracy: 0.4258

Epoch 00028: val_loss did not improve from 1.48852
Epoch 29/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4405 - accuracy: 0.4539 - val_loss: 1.4976 - val_accuracy: 0.4205

Epoch 00029: val_loss did not improve from 1.48852
Epoch 30/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4372 - accuracy: 0.4552 - val_loss: 1.4983 - val_accuracy: 0.4199

Epoch 00030: val_loss did not improve from 1.48852
Epoch 31/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4319 - accuracy: 0.4572 - val_loss: 1.4990 - val_accuracy: 0.4218

Epoch 00031: val_loss did not improve from 1.48852
Epoch 32/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4270 - accuracy: 0.4608 - val_loss: 1.5002 - val_accuracy: 0.4217

Epoch 00032: val_loss did not improve from 1.48852
Epoch 33/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4182 - accuracy: 0.4687 - val_loss: 1.4955 - val_accuracy: 0.4282

Epoch 00033: val_loss did not improve from 1.48852
Epoch 34/100
94/94 [==============================] - 13s 139ms/step - loss: 1.4136 - accuracy: 0.4695 - val_loss: 1.5027 - val_accuracy: 0.4233

Epoch 00034: val_loss did not improve from 1.48852
Epoch 35/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4043 - accuracy: 0.4766 - val_loss: 1.5043 - val_accuracy: 0.4254

Epoch 00035: val_loss did not improve from 1.48852
Epoch 36/100
94/94 [==============================] - 13s 139ms/step - loss: 1.3939 - accuracy: 0.4830 - val_loss: 1.5076 - val_accuracy: 0.4283

Epoch 00036: val_loss did not improve from 1.48852
Epoch 37/100
94/94 [==============================] - 13s 139ms/step - loss: 1.3870 - accuracy: 0.4876 - val_loss: 1.5260 - val_accuracy: 0.4216

Epoch 00037: val_loss did not improve from 1.48852
Epoch 00037: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN_2jet"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential_14 (Sequential)   (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92msequential_15 (Sequential)   (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_39 (Dense)             multiple                  6150      [0m
[92m=================================================================[0m
[92mTotal params: 24,261,974[0m
[92mTrainable params: 24,261,966[0m
[92mNon-trainable params: 8[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_14"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_14 (Lambda)           (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_14 (Batc (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_42 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_42 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_43 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_43 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_44 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_44 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_42 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_14 (Flatten)         (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_35 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_43 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_36 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_44 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_14', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_14_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_14', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQChQJm\nBBkAUwApA07pAAAAAOkCAAAAqQCpAdoBeHIDAAAAcgMAAAD6Hy9ob21lL3NhbWh1YW5nL01ML0NO\nTi9tb2RlbHMucHnaCDxsYW1iZGE+KAEAAPMAAAAA\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_14', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_42', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_42', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_43', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_43', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_44', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_44', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_42', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_14', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_35', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_43', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_36', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_44', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_15"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_15 (Lambda)           (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_15 (Batc (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_45 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_45 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_46 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_46 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_47 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_47 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_45 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_15 (Flatten)         (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_37 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_46 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_38 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_47 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_15', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_15_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_15', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQAhQJm\nBBkAUwCpAk7pAgAAAKkAqQHaAXhyAwAAAHIDAAAA+h8vaG9tZS9zYW1odWFuZy9NTC9DTk4vbW9k\nZWxzLnB52gg8bGFtYmRhPjoBAADzAAAAAA==\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_15', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_45', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_45', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_46', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_46', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_47', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_47', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_45', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_15', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_37', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_46', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_38', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_47', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER3       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_39', 'trainable': True, 'dtype': 'float32', 'units': 6, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
15062/15062 [==============================] - 99s 7ms/step - loss: 1.4868 - accuracy: 0.4306
Testing Loss = 1.486828, Testing Accuracy = 0.430554
The data set contains images
The data set contains images
The data set contains images
Number of training datasets: 48196.
Epoch 1/100
94/94 [==============================] - 14s 138ms/step - loss: 20.9004 - accuracy: 0.2425 - val_loss: 13.1253 - val_accuracy: 0.2696

Epoch 00001: val_loss improved from inf to 13.12533, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 2/100
94/94 [==============================] - 13s 136ms/step - loss: 9.9094 - accuracy: 0.2749 - val_loss: 7.6242 - val_accuracy: 0.2792

Epoch 00002: val_loss improved from 13.12533 to 7.62419, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 3/100
94/94 [==============================] - 13s 136ms/step - loss: 6.4209 - accuracy: 0.2912 - val_loss: 5.4320 - val_accuracy: 0.2872

Epoch 00003: val_loss improved from 7.62419 to 5.43195, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 4/100
94/94 [==============================] - 13s 136ms/step - loss: 4.6722 - accuracy: 0.3553 - val_loss: 4.1005 - val_accuracy: 0.3558

Epoch 00004: val_loss improved from 5.43195 to 4.10048, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 5/100
94/94 [==============================] - 13s 138ms/step - loss: 3.6037 - accuracy: 0.3786 - val_loss: 3.2247 - val_accuracy: 0.3821

Epoch 00005: val_loss improved from 4.10048 to 3.22465, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 6/100
94/94 [==============================] - 13s 137ms/step - loss: 2.9053 - accuracy: 0.3850 - val_loss: 2.6442 - val_accuracy: 0.3930

Epoch 00006: val_loss improved from 3.22465 to 2.64422, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 7/100
94/94 [==============================] - 13s 137ms/step - loss: 2.4381 - accuracy: 0.3878 - val_loss: 2.2633 - val_accuracy: 0.3910

Epoch 00007: val_loss improved from 2.64422 to 2.26333, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 8/100
94/94 [==============================] - 13s 138ms/step - loss: 2.1219 - accuracy: 0.3943 - val_loss: 1.9985 - val_accuracy: 0.4004

Epoch 00008: val_loss improved from 2.26333 to 1.99853, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 9/100
94/94 [==============================] - 13s 137ms/step - loss: 1.9116 - accuracy: 0.3969 - val_loss: 1.8335 - val_accuracy: 0.3961

Epoch 00009: val_loss improved from 1.99853 to 1.83345, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 10/100
94/94 [==============================] - 13s 137ms/step - loss: 1.7752 - accuracy: 0.3979 - val_loss: 1.7216 - val_accuracy: 0.4003

Epoch 00010: val_loss improved from 1.83345 to 1.72165, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 11/100
94/94 [==============================] - 13s 137ms/step - loss: 1.6840 - accuracy: 0.4023 - val_loss: 1.6488 - val_accuracy: 0.4018

Epoch 00011: val_loss improved from 1.72165 to 1.64883, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 12/100
94/94 [==============================] - 13s 137ms/step - loss: 1.6232 - accuracy: 0.4030 - val_loss: 1.6043 - val_accuracy: 0.4044

Epoch 00012: val_loss improved from 1.64883 to 1.60427, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 13/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5836 - accuracy: 0.4066 - val_loss: 1.5733 - val_accuracy: 0.4079

Epoch 00013: val_loss improved from 1.60427 to 1.57334, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 14/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5451 - accuracy: 0.4197 - val_loss: 1.5073 - val_accuracy: 0.4352

Epoch 00014: val_loss improved from 1.57334 to 1.50733, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 15/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4954 - accuracy: 0.4416 - val_loss: 1.4744 - val_accuracy: 0.4468

Epoch 00015: val_loss improved from 1.50733 to 1.47444, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 16/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4708 - accuracy: 0.4517 - val_loss: 1.4590 - val_accuracy: 0.4542

Epoch 00016: val_loss improved from 1.47444 to 1.45897, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 17/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4535 - accuracy: 0.4606 - val_loss: 1.4502 - val_accuracy: 0.4564

Epoch 00017: val_loss improved from 1.45897 to 1.45022, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 18/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4423 - accuracy: 0.4629 - val_loss: 1.4442 - val_accuracy: 0.4596

Epoch 00018: val_loss improved from 1.45022 to 1.44421, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 19/100
94/94 [==============================] - 13s 136ms/step - loss: 1.4335 - accuracy: 0.4670 - val_loss: 1.4378 - val_accuracy: 0.4619

Epoch 00019: val_loss improved from 1.44421 to 1.43778, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 20/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4252 - accuracy: 0.4702 - val_loss: 1.4366 - val_accuracy: 0.4619

Epoch 00020: val_loss improved from 1.43778 to 1.43656, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 21/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4184 - accuracy: 0.4755 - val_loss: 1.4327 - val_accuracy: 0.4617

Epoch 00021: val_loss improved from 1.43656 to 1.43270, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 22/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4117 - accuracy: 0.4777 - val_loss: 1.4240 - val_accuracy: 0.4677

Epoch 00022: val_loss improved from 1.43270 to 1.42401, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 23/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4037 - accuracy: 0.4799 - val_loss: 1.4246 - val_accuracy: 0.4671

Epoch 00023: val_loss did not improve from 1.42401
Epoch 24/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4003 - accuracy: 0.4836 - val_loss: 1.4291 - val_accuracy: 0.4689

Epoch 00024: val_loss did not improve from 1.42401
Epoch 25/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3942 - accuracy: 0.4881 - val_loss: 1.4289 - val_accuracy: 0.4700

Epoch 00025: val_loss did not improve from 1.42401
Epoch 26/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3899 - accuracy: 0.4885 - val_loss: 1.4297 - val_accuracy: 0.4710

Epoch 00026: val_loss did not improve from 1.42401
Epoch 27/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3860 - accuracy: 0.4909 - val_loss: 1.4340 - val_accuracy: 0.4684

Epoch 00027: val_loss did not improve from 1.42401
Epoch 28/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3812 - accuracy: 0.4964 - val_loss: 1.4378 - val_accuracy: 0.4671

Epoch 00028: val_loss did not improve from 1.42401
Epoch 29/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3781 - accuracy: 0.4963 - val_loss: 1.4316 - val_accuracy: 0.4698

Epoch 00029: val_loss did not improve from 1.42401
Epoch 30/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3692 - accuracy: 0.5010 - val_loss: 1.4264 - val_accuracy: 0.4737

Epoch 00030: val_loss did not improve from 1.42401
Epoch 31/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3632 - accuracy: 0.5046 - val_loss: 1.4233 - val_accuracy: 0.4766

Epoch 00031: val_loss improved from 1.42401 to 1.42334, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 32/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3581 - accuracy: 0.5080 - val_loss: 1.4288 - val_accuracy: 0.4760

Epoch 00032: val_loss did not improve from 1.42334
Epoch 33/100
94/94 [==============================] - 13s 139ms/step - loss: 1.3539 - accuracy: 0.5100 - val_loss: 1.4218 - val_accuracy: 0.4772

Epoch 00033: val_loss improved from 1.42334 to 1.42183, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/8
Epoch 34/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3448 - accuracy: 0.5167 - val_loss: 1.4268 - val_accuracy: 0.4786

Epoch 00034: val_loss did not improve from 1.42183
Epoch 35/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3357 - accuracy: 0.5210 - val_loss: 1.4327 - val_accuracy: 0.4744

Epoch 00035: val_loss did not improve from 1.42183
Epoch 36/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3328 - accuracy: 0.5260 - val_loss: 1.4385 - val_accuracy: 0.4771

Epoch 00036: val_loss did not improve from 1.42183
Epoch 37/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3259 - accuracy: 0.5295 - val_loss: 1.4416 - val_accuracy: 0.4748

Epoch 00037: val_loss did not improve from 1.42183
Epoch 38/100
94/94 [==============================] - 13s 137ms/step - loss: 1.3142 - accuracy: 0.5381 - val_loss: 1.4418 - val_accuracy: 0.4764

Epoch 00038: val_loss did not improve from 1.42183
Epoch 39/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3018 - accuracy: 0.5457 - val_loss: 1.4490 - val_accuracy: 0.4748

Epoch 00039: val_loss did not improve from 1.42183
Epoch 40/100
94/94 [==============================] - 13s 138ms/step - loss: 1.2903 - accuracy: 0.5499 - val_loss: 1.4562 - val_accuracy: 0.4735

Epoch 00040: val_loss did not improve from 1.42183
Epoch 41/100
94/94 [==============================] - 13s 138ms/step - loss: 1.2775 - accuracy: 0.5584 - val_loss: 1.4607 - val_accuracy: 0.4739

Epoch 00041: val_loss did not improve from 1.42183
Epoch 42/100
94/94 [==============================] - 13s 138ms/step - loss: 1.2660 - accuracy: 0.5665 - val_loss: 1.4730 - val_accuracy: 0.4714

Epoch 00042: val_loss did not improve from 1.42183
Epoch 43/100
94/94 [==============================] - 13s 138ms/step - loss: 1.2473 - accuracy: 0.5762 - val_loss: 1.4945 - val_accuracy: 0.4684

Epoch 00043: val_loss did not improve from 1.42183
Epoch 00043: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN_2jet"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential_16 (Sequential)   (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92msequential_17 (Sequential)   (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_44 (Dense)             multiple                  6150      [0m
[92m=================================================================[0m
[92mTotal params: 24,261,974[0m
[92mTrainable params: 24,261,966[0m
[92mNon-trainable params: 8[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_16"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_16 (Lambda)           (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_16 (Batc (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_48 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_48 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_49 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_49 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_50 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_50 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_48 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_16 (Flatten)         (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_40 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_49 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_41 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_50 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_16', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_16_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_16', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQChQJm\nBBkAUwApA07pAAAAAOkCAAAAqQCpAdoBeHIDAAAAcgMAAAD6Hy9ob21lL3NhbWh1YW5nL01ML0NO\nTi9tb2RlbHMucHnaCDxsYW1iZGE+KAEAAPMAAAAA\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_16', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_48', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_48', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_49', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_49', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_50', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_50', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_48', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_16', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_40', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_49', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_41', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_50', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_17"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_17 (Lambda)           (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_17 (Batc (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_51 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_51 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_52 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_52 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_53 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_53 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_51 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_17 (Flatten)         (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_42 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_52 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_43 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_53 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_17', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_17_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_17', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQAhQJm\nBBkAUwCpAk7pAgAAAKkAqQHaAXhyAwAAAHIDAAAA+h8vaG9tZS9zYW1odWFuZy9NTC9DTk4vbW9k\nZWxzLnB52gg8bGFtYmRhPjoBAADzAAAAAA==\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_17', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_51', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_51', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_52', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_52', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_53', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_53', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_51', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_17', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_42', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_52', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_43', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_53', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER3       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_44', 'trainable': True, 'dtype': 'float32', 'units': 6, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
15062/15062 [==============================] - 100s 7ms/step - loss: 1.4229 - accuracy: 0.4752
Testing Loss = 1.422882, Testing Accuracy = 0.475169
The data set contains images
The data set contains images
The data set contains images
Number of training datasets: 48196.
Epoch 1/100
94/94 [==============================] - 14s 139ms/step - loss: 20.9489 - accuracy: 0.2392 - val_loss: 13.1642 - val_accuracy: 0.2698

Epoch 00001: val_loss improved from inf to 13.16419, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 2/100
94/94 [==============================] - 13s 137ms/step - loss: 9.9335 - accuracy: 0.2714 - val_loss: 7.6392 - val_accuracy: 0.2793

Epoch 00002: val_loss improved from 13.16419 to 7.63922, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 3/100
94/94 [==============================] - 13s 138ms/step - loss: 6.4366 - accuracy: 0.2859 - val_loss: 5.4430 - val_accuracy: 0.2912

Epoch 00003: val_loss improved from 7.63922 to 5.44304, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 4/100
94/94 [==============================] - 13s 137ms/step - loss: 4.7204 - accuracy: 0.3295 - val_loss: 4.1048 - val_accuracy: 0.3556

Epoch 00004: val_loss improved from 5.44304 to 4.10478, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 5/100
94/94 [==============================] - 13s 139ms/step - loss: 3.6120 - accuracy: 0.3721 - val_loss: 3.2328 - val_accuracy: 0.3769

Epoch 00005: val_loss improved from 4.10478 to 3.23282, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 6/100
94/94 [==============================] - 13s 137ms/step - loss: 2.9088 - accuracy: 0.3833 - val_loss: 2.6448 - val_accuracy: 0.3932

Epoch 00006: val_loss improved from 3.23282 to 2.64483, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 7/100
94/94 [==============================] - 13s 137ms/step - loss: 2.4351 - accuracy: 0.3915 - val_loss: 2.2551 - val_accuracy: 0.3952

Epoch 00007: val_loss improved from 2.64483 to 2.25514, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 8/100
94/94 [==============================] - 13s 137ms/step - loss: 2.1220 - accuracy: 0.3941 - val_loss: 2.0120 - val_accuracy: 0.3907

Epoch 00008: val_loss improved from 2.25514 to 2.01199, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 9/100
94/94 [==============================] - 13s 139ms/step - loss: 1.9136 - accuracy: 0.3961 - val_loss: 1.8324 - val_accuracy: 0.3965

Epoch 00009: val_loss improved from 2.01199 to 1.83243, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 10/100
94/94 [==============================] - 13s 137ms/step - loss: 1.7752 - accuracy: 0.3980 - val_loss: 1.7222 - val_accuracy: 0.3970

Epoch 00010: val_loss improved from 1.83243 to 1.72219, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 11/100
94/94 [==============================] - 13s 137ms/step - loss: 1.6850 - accuracy: 0.4022 - val_loss: 1.6484 - val_accuracy: 0.4040

Epoch 00011: val_loss improved from 1.72219 to 1.64840, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 12/100
94/94 [==============================] - 13s 137ms/step - loss: 1.6224 - accuracy: 0.4055 - val_loss: 1.6000 - val_accuracy: 0.4066

Epoch 00012: val_loss improved from 1.64840 to 1.60002, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 13/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5822 - accuracy: 0.4083 - val_loss: 1.5680 - val_accuracy: 0.4090

Epoch 00013: val_loss improved from 1.60002 to 1.56801, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 14/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5539 - accuracy: 0.4110 - val_loss: 1.5419 - val_accuracy: 0.4136

Epoch 00014: val_loss improved from 1.56801 to 1.54191, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 15/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5326 - accuracy: 0.4152 - val_loss: 1.5275 - val_accuracy: 0.4158

Epoch 00015: val_loss improved from 1.54191 to 1.52747, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 16/100
94/94 [==============================] - 13s 137ms/step - loss: 1.5128 - accuracy: 0.4199 - val_loss: 1.5152 - val_accuracy: 0.4198

Epoch 00016: val_loss improved from 1.52747 to 1.51517, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 17/100
94/94 [==============================] - 13s 138ms/step - loss: 1.5042 - accuracy: 0.4242 - val_loss: 1.5067 - val_accuracy: 0.4229

Epoch 00017: val_loss improved from 1.51517 to 1.50674, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 18/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4946 - accuracy: 0.4256 - val_loss: 1.5031 - val_accuracy: 0.4219

Epoch 00018: val_loss improved from 1.50674 to 1.50310, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 19/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4832 - accuracy: 0.4313 - val_loss: 1.4988 - val_accuracy: 0.4208

Epoch 00019: val_loss improved from 1.50310 to 1.49879, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 20/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4798 - accuracy: 0.4305 - val_loss: 1.4967 - val_accuracy: 0.4205

Epoch 00020: val_loss improved from 1.49879 to 1.49673, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 21/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4742 - accuracy: 0.4345 - val_loss: 1.4960 - val_accuracy: 0.4208

Epoch 00021: val_loss improved from 1.49673 to 1.49597, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 22/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4688 - accuracy: 0.4349 - val_loss: 1.4892 - val_accuracy: 0.4243

Epoch 00022: val_loss improved from 1.49597 to 1.48920, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 23/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4666 - accuracy: 0.4365 - val_loss: 1.4866 - val_accuracy: 0.4245

Epoch 00023: val_loss improved from 1.48920 to 1.48657, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 24/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4620 - accuracy: 0.4375 - val_loss: 1.4875 - val_accuracy: 0.4237

Epoch 00024: val_loss did not improve from 1.48657
Epoch 25/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4533 - accuracy: 0.4434 - val_loss: 1.4883 - val_accuracy: 0.4229

Epoch 00025: val_loss did not improve from 1.48657
Epoch 26/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4498 - accuracy: 0.4444 - val_loss: 1.4898 - val_accuracy: 0.4198

Epoch 00026: val_loss did not improve from 1.48657
Epoch 27/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4475 - accuracy: 0.4461 - val_loss: 1.4849 - val_accuracy: 0.4232

Epoch 00027: val_loss improved from 1.48657 to 1.48493, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 28/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4439 - accuracy: 0.4483 - val_loss: 1.4878 - val_accuracy: 0.4225

Epoch 00028: val_loss did not improve from 1.48493
Epoch 29/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4358 - accuracy: 0.4514 - val_loss: 1.4860 - val_accuracy: 0.4246

Epoch 00029: val_loss did not improve from 1.48493
Epoch 30/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4347 - accuracy: 0.4539 - val_loss: 1.4845 - val_accuracy: 0.4249

Epoch 00030: val_loss improved from 1.48493 to 1.48445, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_2jet_kappa0.15/Try/9
Epoch 31/100
94/94 [==============================] - 13s 137ms/step - loss: 1.4307 - accuracy: 0.4569 - val_loss: 1.4888 - val_accuracy: 0.4255

Epoch 00031: val_loss did not improve from 1.48445
Epoch 32/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4281 - accuracy: 0.4587 - val_loss: 1.4899 - val_accuracy: 0.4273

Epoch 00032: val_loss did not improve from 1.48445
Epoch 33/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4195 - accuracy: 0.4652 - val_loss: 1.4897 - val_accuracy: 0.4251

Epoch 00033: val_loss did not improve from 1.48445
Epoch 34/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4163 - accuracy: 0.4663 - val_loss: 1.4931 - val_accuracy: 0.4267

Epoch 00034: val_loss did not improve from 1.48445
Epoch 35/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4096 - accuracy: 0.4691 - val_loss: 1.4969 - val_accuracy: 0.4254

Epoch 00035: val_loss did not improve from 1.48445
Epoch 36/100
94/94 [==============================] - 13s 138ms/step - loss: 1.4045 - accuracy: 0.4740 - val_loss: 1.4967 - val_accuracy: 0.4243

Epoch 00036: val_loss did not improve from 1.48445
Epoch 37/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3965 - accuracy: 0.4788 - val_loss: 1.5042 - val_accuracy: 0.4231

Epoch 00037: val_loss did not improve from 1.48445
Epoch 38/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3898 - accuracy: 0.4812 - val_loss: 1.5079 - val_accuracy: 0.4216

Epoch 00038: val_loss did not improve from 1.48445
Epoch 39/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3837 - accuracy: 0.4893 - val_loss: 1.5139 - val_accuracy: 0.4219

Epoch 00039: val_loss did not improve from 1.48445
Epoch 40/100
94/94 [==============================] - 13s 138ms/step - loss: 1.3723 - accuracy: 0.4952 - val_loss: 1.5193 - val_accuracy: 0.4221

Epoch 00040: val_loss did not improve from 1.48445
Epoch 00040: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN_2jet"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential_18 (Sequential)   (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92msequential_19 (Sequential)   (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_49 (Dense)             multiple                  6150      [0m
[92m=================================================================[0m
[92mTotal params: 24,261,974[0m
[92mTrainable params: 24,261,966[0m
[92mNon-trainable params: 8[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_18"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_18 (Lambda)           (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_18 (Batc (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_54 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_54 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_55 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_55 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_56 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_56 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_54 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_18 (Flatten)         (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_45 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_55 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_46 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_56 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_18', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_18_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_18', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQChQJm\nBBkAUwApA07pAAAAAOkCAAAAqQCpAdoBeHIDAAAAcgMAAAD6Hy9ob21lL3NhbWh1YW5nL01ML0NO\nTi9tb2RlbHMucHnaCDxsYW1iZGE+KAEAAPMAAAAA\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_18', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_54', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_54', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_55', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_55', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_56', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_56', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_54', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_18', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_45', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_55', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_46', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_56', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential_19"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda_19 (Lambda)           (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization_19 (Batc (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d_57 (Conv2D)           (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_57 (MaxPooling (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_58 (Conv2D)           (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_58 (MaxPooling (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_59 (Conv2D)           (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_59 (MaxPooling (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout_57 (Dropout)         (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten_19 (Flatten)         (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense_47 (Dense)             (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_58 (Dropout)         (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_48 (Dense)             (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_59 (Dropout)         (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 1e-04, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential_19', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 4), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_19_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda_19', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAWQAhQJm\nBBkAUwCpAk7pAgAAAKkAqQHaAXhyAwAAAHIDAAAA+h8vaG9tZS9zYW1odWFuZy9NTC9DTk4vbW9k\nZWxzLnB52gg8bGFtYmRhPjoBAADzAAAAAA==\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization_19', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_57', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_57', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_58', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_58', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_59', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_59', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_57', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten_19', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense_47', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_58', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_48', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_59', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER3       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_49', 'trainable': True, 'dtype': 'float32', 'units': 6, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
15062/15062 [==============================] - 100s 7ms/step - loss: 1.4809 - accuracy: 0.4335
Testing Loss = 1.480944, Testing Accuracy = 0.433475
The data set contains images
N of classes 6
$W^+/W^+$ (auc = 83.18 +- 2.4624 %)
$W^-/W^-$ (auc = 82.71 +- 3.0567 %)
$Z/Z$ (auc = 79.88 +- 0.1470 %)
$W^+/W^-$ (auc = 71.91 +- 3.1622 %)
$W^+/Z$$ (auc = 78.87 +- 0.1740 %)
$W^-/Z$ (auc = 79.89 +- 0.3285 %)
The summarized testing accuracy = 44.84 +- 2.3149 %, with the loss = 1.4579 +- 0.033928
