

$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
New Run
Current date and time = 2022-11-01 21:41:49.045417
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
The data set contains images
Number of training datasets: 383186.
Epoch 1/100
748/748 [==============================] - 69s 69ms/step - loss: 1.4330 - accuracy: 0.4785 - val_loss: 0.9859 - val_accuracy: 0.5012

Epoch 00001: val_loss improved from inf to 0.98594, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 2/100
748/748 [==============================] - 51s 67ms/step - loss: 0.9874 - accuracy: 0.4956 - val_loss: 1.0001 - val_accuracy: 0.4820

Epoch 00002: val_loss did not improve from 0.98594
Epoch 3/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9787 - accuracy: 0.5024 - val_loss: 0.9703 - val_accuracy: 0.5088

Epoch 00003: val_loss improved from 0.98594 to 0.97025, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 4/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9739 - accuracy: 0.5055 - val_loss: 0.9846 - val_accuracy: 0.4951

Epoch 00004: val_loss did not improve from 0.97025
Epoch 5/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9711 - accuracy: 0.5080 - val_loss: 0.9588 - val_accuracy: 0.5144

Epoch 00005: val_loss improved from 0.97025 to 0.95883, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 6/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9682 - accuracy: 0.5097 - val_loss: 0.9544 - val_accuracy: 0.5181

Epoch 00006: val_loss improved from 0.95883 to 0.95440, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 7/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9656 - accuracy: 0.5111 - val_loss: 0.9560 - val_accuracy: 0.5193

Epoch 00007: val_loss did not improve from 0.95440
Epoch 8/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9652 - accuracy: 0.5123 - val_loss: 0.9534 - val_accuracy: 0.5182

Epoch 00008: val_loss improved from 0.95440 to 0.95344, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 9/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9637 - accuracy: 0.5127 - val_loss: 0.9605 - val_accuracy: 0.5118

Epoch 00009: val_loss did not improve from 0.95344
Epoch 10/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9621 - accuracy: 0.5145 - val_loss: 0.9603 - val_accuracy: 0.5115

Epoch 00010: val_loss did not improve from 0.95344
Epoch 11/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9605 - accuracy: 0.5159 - val_loss: 0.9517 - val_accuracy: 0.5189

Epoch 00011: val_loss improved from 0.95344 to 0.95166, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 12/100
748/748 [==============================] - 51s 67ms/step - loss: 0.9588 - accuracy: 0.5172 - val_loss: 0.9560 - val_accuracy: 0.5147

Epoch 00012: val_loss did not improve from 0.95166
Epoch 13/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9576 - accuracy: 0.5192 - val_loss: 0.9575 - val_accuracy: 0.5155

Epoch 00013: val_loss did not improve from 0.95166
Epoch 14/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9560 - accuracy: 0.5212 - val_loss: 0.9564 - val_accuracy: 0.5281

Epoch 00014: val_loss did not improve from 0.95166
Epoch 15/100
748/748 [==============================] - 50s 67ms/step - loss: 0.8677 - accuracy: 0.6378 - val_loss: 0.8072 - val_accuracy: 0.6749

Epoch 00015: val_loss improved from 0.95166 to 0.80720, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 16/100
748/748 [==============================] - 51s 68ms/step - loss: 0.8229 - accuracy: 0.6650 - val_loss: 0.7916 - val_accuracy: 0.6766

Epoch 00016: val_loss improved from 0.80720 to 0.79157, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 17/100
748/748 [==============================] - 51s 68ms/step - loss: 0.8166 - accuracy: 0.6673 - val_loss: 0.7922 - val_accuracy: 0.6771

Epoch 00017: val_loss did not improve from 0.79157
Epoch 18/100
748/748 [==============================] - 51s 68ms/step - loss: 0.8095 - accuracy: 0.6717 - val_loss: 0.7883 - val_accuracy: 0.6795

Epoch 00018: val_loss improved from 0.79157 to 0.78829, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 19/100
748/748 [==============================] - 50s 67ms/step - loss: 0.8064 - accuracy: 0.6734 - val_loss: 0.7915 - val_accuracy: 0.6794

Epoch 00019: val_loss did not improve from 0.78829
Epoch 20/100
748/748 [==============================] - 50s 67ms/step - loss: 0.8037 - accuracy: 0.6751 - val_loss: 0.7877 - val_accuracy: 0.6783

Epoch 00020: val_loss improved from 0.78829 to 0.78774, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 21/100
748/748 [==============================] - 51s 67ms/step - loss: 0.8004 - accuracy: 0.6768 - val_loss: 0.7894 - val_accuracy: 0.6767

Epoch 00021: val_loss did not improve from 0.78774
Epoch 22/100
748/748 [==============================] - 50s 67ms/step - loss: 0.7998 - accuracy: 0.6783 - val_loss: 0.7907 - val_accuracy: 0.6765

Epoch 00022: val_loss did not improve from 0.78774
Epoch 23/100
748/748 [==============================] - 51s 68ms/step - loss: 0.7979 - accuracy: 0.6789 - val_loss: 0.7919 - val_accuracy: 0.6749

Epoch 00023: val_loss did not improve from 0.78774
Epoch 24/100
748/748 [==============================] - 53s 71ms/step - loss: 0.7955 - accuracy: 0.6809 - val_loss: 0.7942 - val_accuracy: 0.6771

Epoch 00024: val_loss did not improve from 0.78774
Epoch 25/100
748/748 [==============================] - 51s 68ms/step - loss: 0.7926 - accuracy: 0.6828 - val_loss: 0.7925 - val_accuracy: 0.6752

Epoch 00025: val_loss did not improve from 0.78774
Epoch 26/100
748/748 [==============================] - 50s 67ms/step - loss: 0.7920 - accuracy: 0.6841 - val_loss: 0.7976 - val_accuracy: 0.6705

Epoch 00026: val_loss did not improve from 0.78774
Epoch 27/100
748/748 [==============================] - 50s 67ms/step - loss: 0.7913 - accuracy: 0.6845 - val_loss: 0.7983 - val_accuracy: 0.6712

Epoch 00027: val_loss did not improve from 0.78774
Epoch 28/100
748/748 [==============================] - 50s 67ms/step - loss: 0.7862 - accuracy: 0.6870 - val_loss: 0.7922 - val_accuracy: 0.6775

Epoch 00028: val_loss did not improve from 0.78774
Epoch 29/100
748/748 [==============================] - 51s 68ms/step - loss: 0.7851 - accuracy: 0.6892 - val_loss: 0.8038 - val_accuracy: 0.6664

Epoch 00029: val_loss did not improve from 0.78774
Epoch 30/100
748/748 [==============================] - 50s 67ms/step - loss: 0.7833 - accuracy: 0.6902 - val_loss: 0.7958 - val_accuracy: 0.6768

Epoch 00030: val_loss did not improve from 0.78774
Epoch 00030: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential (Sequential)      (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_2 (Dense)              multiple                  1539      [0m
[92m=================================================================[0m
[92mTotal params: 12,129,451[0m
[92mTrainable params: 12,129,447[0m
[92mNon-trainable params: 4[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda (Lambda)              (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization (BatchNo (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d (Conv2D)              (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d (MaxPooling2D) (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_1 (Conv2D)            (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_1 (MaxPooling2 (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_2 (Conv2D)            (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_2 (MaxPooling2 (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout (Dropout)            (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten (Flatten)            (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense (Dense)                (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_1 (Dropout)          (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_1 (Dense)              (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_2 (Dropout)          (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 0.001, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 2), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAGQAhQJm\nBBkAUwApAU6pAKkB2gF4cgEAAAByAQAAAPofL2hvbWUvc2FtaHVhbmcvTUwvQ05OL21vZGVscy5w\nedoIPGxhbWJkYT4PAAAA8wAAAAA=\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_1', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_1', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_2', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_2', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_1', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_1', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_2', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_2', 'trainable': True, 'dtype': 'float32', 'units': 3, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
119746/119746 [==============================] - 562s 5ms/step - loss: 0.7914 - accuracy: 0.6773
Testing Loss = 0.791429, Testing Accuracy = 0.677309
The data set contains images
N of classes 3
$W^+$ (auc = 84.85 +- 0.0000 %)
$W^-$ (auc = 84.84 +- 0.0000 %)
$Z$ (auc = 82.95 +- 0.0000 %)
The summarized testing accuracy = 67.73 +- 0.0000 %, with the loss = 0.7914 +- 0.000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     748/748 [==============================] - 54s 67ms/step - loss: 1.4753 - accuracy: 0.4769 - val_loss: 0.9830 - val_accuracy: 0.5024

Epoch 00001: val_loss improved from inf to 0.98303, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 2/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9875 - accuracy: 0.4961 - val_loss: 0.9789 - val_accuracy: 0.5016

Epoch 00002: val_loss improved from 0.98303 to 0.97892, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 3/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9791 - accuracy: 0.5015 - val_loss: 0.9739 - val_accuracy: 0.5043

Epoch 00003: val_loss improved from 0.97892 to 0.97388, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 4/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9751 - accuracy: 0.5042 - val_loss: 0.9628 - val_accuracy: 0.5124

Epoch 00004: val_loss improved from 0.97388 to 0.96276, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 5/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9718 - accuracy: 0.5067 - val_loss: 0.9675 - val_accuracy: 0.5068

Epoch 00005: val_loss did not improve from 0.96276
Epoch 6/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9683 - accuracy: 0.5094 - val_loss: 0.9568 - val_accuracy: 0.5178

Epoch 00006: val_loss improved from 0.96276 to 0.95680, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 7/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9669 - accuracy: 0.5106 - val_loss: 0.9577 - val_accuracy: 0.5145

Epoch 00007: val_loss did not improve from 0.95680
Epoch 8/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9657 - accuracy: 0.5109 - val_loss: 0.9603 - val_accuracy: 0.5116

Epoch 00008: val_loss did not improve from 0.95680
Epoch 9/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9630 - accuracy: 0.5130 - val_loss: 0.9636 - val_accuracy: 0.5095

Epoch 00009: val_loss did not improve from 0.95680
Epoch 10/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9614 - accuracy: 0.5144 - val_loss: 0.9578 - val_accuracy: 0.5129

Epoch 00010: val_loss did not improve from 0.95680
Epoch 11/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9598 - accuracy: 0.5160 - val_loss: 0.9543 - val_accuracy: 0.5161

Epoch 00011: val_loss improved from 0.95680 to 0.95425, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 12/100
748/748 [==============================] - 50s 67ms/step - loss: 0.9578 - accuracy: 0.5172 - val_loss: 0.9589 - val_accuracy: 0.5128

Epoch 00012: val_loss did not improve from 0.95425
Epoch 13/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9565 - accuracy: 0.5184 - val_loss: 0.9509 - val_accuracy: 0.5196

Epoch 00013: val_loss improved from 0.95425 to 0.95095, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 14/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9552 - accuracy: 0.5206 - val_loss: 0.9545 - val_accuracy: 0.5166

Epoch 00014: val_loss did not improve from 0.95095
Epoch 15/100
748/748 [==============================] - 51s 68ms/step - loss: 0.9299 - accuracy: 0.5633 - val_loss: 0.8388 - val_accuracy: 0.6567

Epoch 00015: val_loss improved from 0.95095 to 0.83877, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 16/100
748/748 [==============================] - 50s 67ms/step - loss: 0.8372 - accuracy: 0.6595 - val_loss: 0.8186 - val_accuracy: 0.6629

Epoch 00016: val_loss improved from 0.83877 to 0.81860, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 17/100
748/748 [==============================] - 51s 68ms/step - loss: 0.8222 - accuracy: 0.6668 - val_loss: 0.8027 - val_accuracy: 0.6735

Epoch 00017: val_loss improved from 0.81860 to 0.80267, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 18/100
748/748 [==============================] - 51s 68ms/step - loss: 0.8135 - accuracy: 0.6720 - val_loss: 0.7967 - val_accuracy: 0.6802

Epoch 00018: val_loss improved from 0.80267 to 0.79668, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 19/100
748/748 [==============================] - 51s 68ms/step - loss: 0.8097 - accuracy: 0.6738 - val_loss: 0.7918 - val_accuracy: 0.6784

Epoch 00019: val_loss improved from 0.79668 to 0.79177, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 20/100
748/748 [==============================] - 51s 68ms/step - loss: 0.8062 - accuracy: 0.6756 - val_loss: 0.7900 - val_accuracy: 0.6808

Epoch 00020: val_loss improved from 0.79177 to 0.79003, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 21/100
748/748 [==============================] - 51s 68ms/step - loss: 0.8028 - accuracy: 0.6780 - val_loss: 0.7920 - val_accuracy: 0.6786

Epoch 00021: val_loss did not improve from 0.79003
Epoch 22/100
748/748 [==============================] - 51s 68ms/step - loss: 0.7994 - accuracy: 0.6800 - val_loss: 0.7897 - val_accuracy: 0.6803

Epoch 00022: val_loss improved from 0.79003 to 0.78972, saving model to /home/samhuang/ML/best_model/best_model_ternary_CNN_kappa0.15-test/Try/0
Epoch 23/100
748/748 [==============================] - 51s 68ms/step - loss: 0.7959 - accuracy: 0.6828 - val_loss: 0.7976 - val_accuracy: 0.6757

Epoch 00023: val_loss did not improve from 0.78972
Epoch 24/100
748/748 [==============================] - 51s 68ms/step - loss: 0.7957 - accuracy: 0.6829 - val_loss: 0.7984 - val_accuracy: 0.6708

Epoch 00024: val_loss did not improve from 0.78972
Epoch 25/100
748/748 [==============================] - 51s 68ms/step - loss: 0.7928 - accuracy: 0.6860 - val_loss: 0.7960 - val_accuracy: 0.6794

Epoch 00025: val_loss did not improve from 0.78972
Epoch 26/100
748/748 [==============================] - 51s 68ms/step - loss: 0.7884 - accuracy: 0.6881 - val_loss: 0.7938 - val_accuracy: 0.6766

Epoch 00026: val_loss did not improve from 0.78972
Epoch 27/100
748/748 [==============================] - 50s 67ms/step - loss: 0.7871 - accuracy: 0.6898 - val_loss: 0.8041 - val_accuracy: 0.6716

Epoch 00027: val_loss did not improve from 0.78972
Epoch 28/100
748/748 [==============================] - 50s 67ms/step - loss: 0.7850 - accuracy: 0.6912 - val_loss: 0.7971 - val_accuracy: 0.6736

Epoch 00028: val_loss did not improve from 0.78972
Epoch 29/100
748/748 [==============================] - 51s 68ms/step - loss: 0.7820 - accuracy: 0.6934 - val_loss: 0.7993 - val_accuracy: 0.6717

Epoch 00029: val_loss did not improve from 0.78972
Epoch 30/100
748/748 [==============================] - 50s 67ms/step - loss: 0.7824 - accuracy: 0.6938 - val_loss: 0.8017 - val_accuracy: 0.6722

Epoch 00030: val_loss did not improve from 0.78972
Epoch 31/100
748/748 [==============================] - 51s 68ms/step - loss: 0.7794 - accuracy: 0.6957 - val_loss: 0.8153 - val_accuracy: 0.6705

Epoch 00031: val_loss did not improve from 0.78972
Epoch 32/100
748/748 [==============================] - 50s 67ms/step - loss: 0.7773 - accuracy: 0.6971 - val_loss: 0.8099 - val_accuracy: 0.6713

Epoch 00032: val_loss did not improve from 0.78972
Epoch 00032: early stopping
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
[92mModel: "CNN"[0m
[92m_________________________________________________________________[0m
[92mLayer (type)                 Output Shape              Param #   [0m
[92m=================================================================[0m
[92msequential (Sequential)      (None, 512)               12127912  [0m
[92m_________________________________________________________________[0m
[92mdense_2 (Dense)              multiple                  1539      [0m
[92m=================================================================[0m
[92mTotal params: 12,129,451[0m
[92mTrainable params: 12,129,447[0m
[92mNon-trainable params: 4[0m
[92m_________________________________________________________________[0m
None

@LAYER1       @@@@@@@@@@@@@@@@@@@@@@
[94mModel: "sequential"[0m
[94m_________________________________________________________________[0m
[94mLayer (type)                 Output Shape              Param #   [0m
[94m=================================================================[0m
[94mlambda (Lambda)              (None, 75, 75, 2)         0         [0m
[94m_________________________________________________________________[0m
[94mbatch_normalization (BatchNo (None, 75, 75, 2)         8         [0m
[94m_________________________________________________________________[0m
[94mconv2d (Conv2D)              (None, 75, 75, 32)        2336      [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d (MaxPooling2D) (None, 37, 37, 32)        0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_1 (Conv2D)            (None, 37, 37, 128)       65664     [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_1 (MaxPooling2 (None, 18, 18, 128)       0         [0m
[94m_________________________________________________________________[0m
[94mconv2d_2 (Conv2D)            (None, 18, 18, 256)       1179904   [0m
[94m_________________________________________________________________[0m
[94mmax_pooling2d_2 (MaxPooling2 (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mdropout (Dropout)            (None, 9, 9, 256)         0         [0m
[94m_________________________________________________________________[0m
[94mflatten (Flatten)            (None, 20736)             0         [0m
[94m_________________________________________________________________[0m
[94mdense (Dense)                (None, 512)               10617344  [0m
[94m_________________________________________________________________[0m
[94mdropout_1 (Dropout)          (None, 512)               0         [0m
[94m_________________________________________________________________[0m
[94mdense_1 (Dense)              (None, 512)               262656    [0m
[94m_________________________________________________________________[0m
[94mdropout_2 (Dropout)          (None, 512)               0         [0m
[94m=================================================================[0m
[94mTotal params: 12,127,912[0m
[94mTrainable params: 12,127,908[0m
[94mNon-trainable params: 4[0m
[94m_________________________________________________________________[0m
None
[92m%Optimizer:
[0m {'name': 'Adam', 'learning_rate': 0.001, 'decay': 0.0, 'beta_1': 0.9, 'beta_2': 0.999, 'epsilon': 1e-07, 'amsgrad': False}
[92m%Layer detail:
[0m {'name': 'sequential', 'layers': [{'class_name': 'InputLayer', 'config': {'batch_input_shape': (None, 75, 75, 2), 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'lambda_input'}}, {'class_name': 'Lambda', 'config': {'name': 'lambda', 'trainable': True, 'dtype': 'float32', 'function': ('4wEAAAAAAAAAAAAAAAEAAAAGAAAAUwAAAHMgAAAAfABkAGQAhQJkAGQAhQJkAGQAhQJkAGQAhQJm\nBBkAUwApAU6pAKkB2gF4cgEAAAByAQAAAPofL2hvbWUvc2FtaHVhbmcvTUwvQ05OL21vZGVscy5w\nedoIPGxhbWJkYT4PAAAA8wAAAAA=\n', None, None), 'function_type': 'lambda', 'module': 'models', 'output_shape': None, 'output_shape_type': 'raw', 'output_shape_module': None, 'arguments': {}}}, {'class_name': 'BatchNormalization', 'config': {'name': 'batch_normalization', 'trainable': True, 'dtype': 'float32', 'axis': ListWrapper([3]), 'momentum': 0.99, 'epsilon': 0.001, 'center': True, 'scale': True, 'beta_initializer': {'class_name': 'Zeros', 'config': {}}, 'gamma_initializer': {'class_name': 'Ones', 'config': {}}, 'moving_mean_initializer': {'class_name': 'Zeros', 'config': {}}, 'moving_variance_initializer': {'class_name': 'Ones', 'config': {}}, 'beta_regularizer': None, 'gamma_regularizer': None, 'beta_constraint': None, 'gamma_constraint': None}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d', 'trainable': True, 'dtype': 'float32', 'filters': 32, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_1', 'trainable': True, 'dtype': 'float32', 'filters': 128, 'kernel_size': (4, 4), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_1', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Conv2D', 'config': {'name': 'conv2d_2', 'trainable': True, 'dtype': 'float32', 'filters': 256, 'kernel_size': (6, 6), 'strides': (1, 1), 'padding': 'same', 'data_format': 'channels_last', 'dilation_rate': (1, 1), 'groups': 1, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'MaxPooling2D', 'config': {'name': 'max_pooling2d_2', 'trainable': True, 'dtype': 'float32', 'pool_size': (2, 2), 'padding': 'valid', 'strides': (2, 2), 'data_format': 'channels_last'}}, {'class_name': 'Dropout', 'config': {'name': 'dropout', 'trainable': True, 'dtype': 'float32', 'rate': 0.1, 'noise_shape': None, 'seed': None}}, {'class_name': 'Flatten', 'config': {'name': 'flatten', 'trainable': True, 'dtype': 'float32', 'data_format': 'channels_last'}}, {'class_name': 'Dense', 'config': {'name': 'dense', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_1', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}, {'class_name': 'Dense', 'config': {'name': 'dense_1', 'trainable': True, 'dtype': 'float32', 'units': 512, 'activation': 'relu', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': {'class_name': 'L2', 'config': {'l2': 0.009999999776482582}}, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}}, {'class_name': 'Dropout', 'config': {'name': 'dropout_2', 'trainable': True, 'dtype': 'float32', 'rate': 0.5, 'noise_shape': None, 'seed': None}}]}

@LAYER2       @@@@@@@@@@@@@@@@@@@@@@
[92m%Layer detail:
[0m {'name': 'dense_2', 'trainable': True, 'dtype': 'float32', 'units': 3, 'activation': 'softmax', 'use_bias': True, 'kernel_initializer': {'class_name': 'GlorotUniform', 'config': {'seed': None}}, 'bias_initializer': {'class_name': 'Zeros', 'config': {}}, 'kernel_regularizer': None, 'bias_regularizer': None, 'activity_regularizer': None, 'kernel_constraint': None, 'bias_constraint': None}

****************************************************
history keys:
 dict_keys(['loss', 'accuracy', 'val_loss', 'val_accuracy'])
history params:
 {'verbose': 1, 'epochs': 100, 'steps': None}
****************************************************
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
The data set contains images
119746/119746 [==============================] - 525s 4ms/step - loss: 0.7941 - accuracy: 0.6776
Testing Loss = 0.794068, Testing Accuracy = 0.677551
The data set contains images
N of classes 3
$W^+$ (auc = 84.93 +- 0.0000 %)
$W^-$ (auc = 84.82 +- 0.0000 %)
$Z$ (auc = 82.85 +- 0.0000 %)
The summarized testing accuracy = 67.76 +- 0.0000 %, with the loss = 0.7941 +- 0.000000
